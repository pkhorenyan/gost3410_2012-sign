
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Library reference &#8212; pyderasn 9.3 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '9.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="News" href="news.html" />
    <link rel="prev" title="Examples" href="examples.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="news.html" title="News"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyderasn 9.3 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="library-reference">
<h1><a class="toc-backref" href="#toc-entry-1">Library reference</a><a class="headerlink" href="#library-reference" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#library-reference" id="toc-entry-1">Library reference</a><ul>
<li><a class="reference internal" href="#common-for-most-types" id="toc-entry-2">Common for most types</a><ul>
<li><a class="reference internal" href="#tags" id="toc-entry-3">Tags</a></li>
<li><a class="reference internal" href="#default-optional" id="toc-entry-4">Default/optional</a></li>
<li><a class="reference internal" href="#size-constraints" id="toc-entry-5">Size constraints</a></li>
<li><a class="reference internal" href="#common-methods" id="toc-entry-6">Common methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#decoding-1" id="toc-entry-7">Decoding</a><ul>
<li><a class="reference internal" href="#context" id="toc-entry-8">Context</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pretty-printing" id="toc-entry-9">Pretty printing</a></li>
<li><a class="reference internal" href="#defined-by" id="toc-entry-10">DEFINED BY</a><ul>
<li><a class="reference internal" href="#defines-kwarg" id="toc-entry-11">defines kwarg</a></li>
<li><a class="reference internal" href="#defines-by-path-context-option" id="toc-entry-12">defines_by_path context option</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ber-encoding" id="toc-entry-13">BER encoding</a></li>
<li><a class="reference internal" href="#allow-explicit-tag-out-of-bound" id="toc-entry-14">Allow explicit tag out-of-bound</a></li>
<li><a class="reference internal" href="#streaming-and-dealing-with-huge-structures" id="toc-entry-15">Streaming and dealing with huge structures</a><ul>
<li><a class="reference internal" href="#evgen-mode-1" id="toc-entry-16">evgen mode</a></li>
<li><a class="reference internal" href="#evgen-mode-upto" id="toc-entry-17">evgen_mode_upto</a></li>
<li><a class="reference internal" href="#mmap-ed-file" id="toc-entry-18">mmap-ed file</a></li>
<li><a class="reference internal" href="#cer-encoding" id="toc-entry-19">CER encoding</a></li>
<li><a class="reference internal" href="#agg-octet-string-1" id="toc-entry-20">agg_octet_string</a></li>
<li><a class="reference internal" href="#sequence-of-iterators" id="toc-entry-21">SEQUENCE OF iterators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pass-der-encoding" id="toc-entry-22">2-pass DER encoding</a></li>
<li><a class="reference internal" href="#asn-1-browser" id="toc-entry-23">ASN.1 browser</a></li>
<li><a class="reference internal" href="#base-obj" id="toc-entry-24">Base Obj</a></li>
<li><a class="reference internal" href="#primitive-types" id="toc-entry-25">Primitive types</a><ul>
<li><a class="reference internal" href="#boolean" id="toc-entry-26">Boolean</a></li>
<li><a class="reference internal" href="#integer" id="toc-entry-27">Integer</a></li>
<li><a class="reference internal" href="#bitstring" id="toc-entry-28">BitString</a></li>
<li><a class="reference internal" href="#octetstring" id="toc-entry-29">OctetString</a></li>
<li><a class="reference internal" href="#null" id="toc-entry-30">Null</a></li>
<li><a class="reference internal" href="#objectidentifier" id="toc-entry-31">ObjectIdentifier</a></li>
<li><a class="reference internal" href="#enumerated" id="toc-entry-32">Enumerated</a></li>
<li><a class="reference internal" href="#commonstring" id="toc-entry-33">CommonString</a></li>
<li><a class="reference internal" href="#numericstring" id="toc-entry-34">NumericString</a></li>
<li><a class="reference internal" href="#printablestring" id="toc-entry-35">PrintableString</a></li>
<li><a class="reference internal" href="#ia5string" id="toc-entry-36">IA5String</a></li>
<li><a class="reference internal" href="#visiblestring" id="toc-entry-37">VisibleString</a></li>
<li><a class="reference internal" href="#utctime" id="toc-entry-38">UTCTime</a></li>
<li><a class="reference internal" href="#generalizedtime" id="toc-entry-39">GeneralizedTime</a></li>
</ul>
</li>
<li><a class="reference internal" href="#special-types" id="toc-entry-40">Special types</a><ul>
<li><a class="reference internal" href="#choice" id="toc-entry-41">Choice</a></li>
<li><a class="reference internal" href="#primitivetypes" id="toc-entry-42">PrimitiveTypes</a></li>
<li><a class="reference internal" href="#any" id="toc-entry-43">Any</a></li>
</ul>
</li>
<li><a class="reference internal" href="#constructed-types" id="toc-entry-44">Constructed types</a><ul>
<li><a class="reference internal" href="#sequence" id="toc-entry-45">Sequence</a></li>
<li><a class="reference internal" href="#set" id="toc-entry-46">Set</a></li>
<li><a class="reference internal" href="#sequenceof" id="toc-entry-47">SequenceOf</a></li>
<li><a class="reference internal" href="#setof" id="toc-entry-48">SetOf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#various" id="toc-entry-49">Various</a></li>
<li><a class="reference internal" href="#command-line-usage" id="toc-entry-50">Command-line usage</a><ul>
<li><a class="reference internal" href="#human-readable-oids" id="toc-entry-51">Human readable OIDs</a></li>
<li><a class="reference internal" href="#decode-paths" id="toc-entry-52">Decode paths</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<span class="target" id="module-pyderasn"></span><p>Python ASN.1 DER/CER/BER codec with abstract structures</p>
<p>This library allows you to marshal various structures in ASN.1 DER/CER
format, unmarshal BER/CER/DER ones.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">123</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">raw</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Integer</span><span class="p">()</span><span class="o">.</span><span class="n">decod</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span> <span class="o">==</span> <span class="n">i</span>
<span class="go">True</span>
</pre></div>
</div>
<p>There are primitive types, holding single values
(<a class="reference internal" href="#pyderasn.BitString" title="pyderasn.BitString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.BitString</span></code></a>,
<a class="reference internal" href="#pyderasn.Boolean" title="pyderasn.Boolean"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Boolean</span></code></a>,
<a class="reference internal" href="#pyderasn.Enumerated" title="pyderasn.Enumerated"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Enumerated</span></code></a>,
<a class="reference internal" href="#pyderasn.GeneralizedTime" title="pyderasn.GeneralizedTime"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.GeneralizedTime</span></code></a>,
<a class="reference internal" href="#pyderasn.Integer" title="pyderasn.Integer"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Integer</span></code></a>,
<a class="reference internal" href="#pyderasn.Null" title="pyderasn.Null"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Null</span></code></a>,
<a class="reference internal" href="#pyderasn.ObjectIdentifier" title="pyderasn.ObjectIdentifier"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.ObjectIdentifier</span></code></a>,
<a class="reference internal" href="#pyderasn.OctetString" title="pyderasn.OctetString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.OctetString</span></code></a>,
<a class="reference internal" href="#pyderasn.UTCTime" title="pyderasn.UTCTime"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.UTCTime</span></code></a>,
<a class="reference internal" href="#pyderasn.CommonString" title="pyderasn.CommonString"><code class="xref py py-class docutils literal"><span class="pre">various</span> <span class="pre">strings</span></code></a>
(<code class="xref py py-class docutils literal"><span class="pre">pyderasn.BMPString</span></code>,
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.GeneralString</span></code>,
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.GraphicString</span></code>,
<a class="reference internal" href="#pyderasn.IA5String" title="pyderasn.IA5String"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.IA5String</span></code></a>,
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.ISO646String</span></code>,
<a class="reference internal" href="#pyderasn.NumericString" title="pyderasn.NumericString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.NumericString</span></code></a>,
<a class="reference internal" href="#pyderasn.PrintableString" title="pyderasn.PrintableString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.PrintableString</span></code></a>,
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.T61String</span></code>,
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.TeletexString</span></code>,
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.UniversalString</span></code>,
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.UTF8String</span></code>,
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.VideotexString</span></code>,
<a class="reference internal" href="#pyderasn.VisibleString" title="pyderasn.VisibleString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.VisibleString</span></code></a>)),
constructed types, holding multiple primitive types
(<a class="reference internal" href="#pyderasn.Sequence" title="pyderasn.Sequence"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Sequence</span></code></a>,
<a class="reference internal" href="#pyderasn.SequenceOf" title="pyderasn.SequenceOf"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.SequenceOf</span></code></a>,
<a class="reference internal" href="#pyderasn.Set" title="pyderasn.Set"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Set</span></code></a>,
<a class="reference internal" href="#pyderasn.SetOf" title="pyderasn.SetOf"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.SetOf</span></code></a>),
and special types like
<a class="reference internal" href="#pyderasn.Any" title="pyderasn.Any"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Any</span></code></a> and
<a class="reference internal" href="#pyderasn.Choice" title="pyderasn.Choice"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Choice</span></code></a>.</p>
<div class="section" id="common-for-most-types">
<h2><a class="toc-backref" href="#toc-entry-2">Common for most types</a><a class="headerlink" href="#common-for-most-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="tags">
<h3><a class="toc-backref" href="#toc-entry-3">Tags</a><a class="headerlink" href="#tags" title="Permalink to this headline">¶</a></h3>
<p>Most types in ASN.1 has specific tag for them. <code class="docutils literal"><span class="pre">Obj.tag_default</span></code> is
the default tag used during coding process. You can override it with
either <code class="docutils literal"><span class="pre">IMPLICIT</span></code> (using either <code class="docutils literal"><span class="pre">impl</span></code> keyword argument or <code class="docutils literal"><span class="pre">impl</span></code>
class attribute), or <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one (using either <code class="docutils literal"><span class="pre">expl</span></code> keyword
argument or <code class="docutils literal"><span class="pre">expl</span></code> class attribute). Both arguments take raw binary
string, containing that tag. You can <strong>not</strong> set implicit and explicit
tags simultaneously.</p>
<p>There are <a class="reference internal" href="#pyderasn.tag_ctxp" title="pyderasn.tag_ctxp"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.tag_ctxp()</span></code></a> and <a class="reference internal" href="#pyderasn.tag_ctxc" title="pyderasn.tag_ctxc"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.tag_ctxc()</span></code></a>
functions, allowing you to easily create <code class="docutils literal"><span class="pre">CONTEXT</span></code>
<code class="docutils literal"><span class="pre">PRIMITIVE</span></code>/<code class="docutils literal"><span class="pre">CONSTRUCTED</span></code> tags, by specifying only the required tag
number.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">EXPLICIT tags always have <strong>constructed</strong> tag. PyDERASN does not
explicitly check correctness of schema input here.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Implicit tags have <strong>primitive</strong> (<code class="docutils literal"><span class="pre">tag_ctxp</span></code>) encoding for
primitive values.</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Integer</span><span class="p">(</span><span class="n">impl</span><span class="o">=</span><span class="n">tag_ctxp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[1] INTEGER</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Integer</span><span class="p">(</span><span class="n">expl</span><span class="o">=</span><span class="n">tag_ctxc</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">[2] EXPLICIT INTEGER</span>
</pre></div>
</div>
<p>Implicit tag is not explicitly shown.</p>
<p>Two objects of the same type, but with different implicit/explicit tags
are <strong>not</strong> equal.</p>
<p>You can get object’s effective tag (either default or implicited) through
<code class="docutils literal"><span class="pre">tag</span></code> property. You can decode it using <a class="reference internal" href="#pyderasn.tag_decode" title="pyderasn.tag_decode"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.tag_decode()</span></code></a>
function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tag_decode</span><span class="p">(</span><span class="n">tag_ctxc</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<span class="go">(128, 32, 123)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">klass</span><span class="p">,</span> <span class="n">form</span><span class="p">,</span> <span class="n">num</span> <span class="o">=</span> <span class="n">tag_decode</span><span class="p">(</span><span class="n">tag_ctxc</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">klass</span> <span class="o">==</span> <span class="n">TagClassContext</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">form</span> <span class="o">==</span> <span class="n">TagFormConstructed</span>
<span class="go">True</span>
</pre></div>
</div>
<p>To determine if object has explicit tag, use <code class="docutils literal"><span class="pre">expled</span></code> boolean property
and <code class="docutils literal"><span class="pre">expl_tag</span></code> property, returning explicit tag’s value.</p>
</div>
<div class="section" id="default-optional">
<h3><a class="toc-backref" href="#toc-entry-4">Default/optional</a><a class="headerlink" href="#default-optional" title="Permalink to this headline">¶</a></h3>
<p>Many objects in sequences could be <code class="docutils literal"><span class="pre">OPTIONAL</span></code> and could have
<code class="docutils literal"><span class="pre">DEFAULT</span></code> value. You can specify that object’s property using
corresponding keyword arguments.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Integer</span><span class="p">(</span><span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">123</span><span class="p">)</span>
<span class="go">INTEGER 123 OPTIONAL DEFAULT</span>
</pre></div>
</div>
<p>Those specifications do not play any role in primitive value encoding,
but are taken into account when dealing with sequences holding them. For
example <code class="docutils literal"><span class="pre">TBSCertificate</span></code> sequence holds defaulted, explicitly tagged
<code class="docutils literal"><span class="pre">version</span></code> field:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Version</span><span class="p">(</span><span class="n">Integer</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;v2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
<span class="k">class</span> <span class="nc">TBSCertificate</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="n">Version</span><span class="p">(</span><span class="n">expl</span><span class="o">=</span><span class="n">tag_ctxc</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">)),</span>
    <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>When default argument is used and value is not specified, then it equals
to default one.</p>
</div>
<div class="section" id="size-constraints">
<span id="bounds"></span><h3><a class="toc-backref" href="#toc-entry-5">Size constraints</a><a class="headerlink" href="#size-constraints" title="Permalink to this headline">¶</a></h3>
<p>Some objects give ability to set value size constraints. This is either
possible integer value, or allowed length of various strings and
sequences. Constraints are set in the following way:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">X</span><span class="p">(</span><span class="o">...</span><span class="p">):</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="n">MIN</span><span class="p">,</span> <span class="n">MAX</span><span class="p">)</span>
</pre></div>
</div>
<p>And values satisfaction is checked as: <code class="docutils literal"><span class="pre">MIN</span> <span class="pre">&lt;=</span> <span class="pre">X</span> <span class="pre">&lt;=</span> <span class="pre">MAX</span></code>.</p>
<p>For simplicity you can also set bounds the following way:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">bounded_x</span> <span class="o">=</span> <span class="n">X</span><span class="p">(</span><span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="n">MIN</span><span class="p">,</span> <span class="n">MAX</span><span class="p">))</span>
</pre></div>
</div>
<p>If bounds are not satisfied, then <a class="reference internal" href="#pyderasn.BoundsError" title="pyderasn.BoundsError"><code class="xref py py-exc docutils literal"><span class="pre">pyderasn.BoundsError</span></code></a> is
raised.</p>
</div>
<div class="section" id="common-methods">
<h3><a class="toc-backref" href="#toc-entry-6">Common methods</a><a class="headerlink" href="#common-methods" title="Permalink to this headline">¶</a></h3>
<p>All objects have <code class="docutils literal"><span class="pre">ready</span></code> boolean property, that tells if object is
ready to be encoded. If that kind of action is performed on unready
object, then <a class="reference internal" href="#pyderasn.ObjNotReady" title="pyderasn.ObjNotReady"><code class="xref py py-exc docutils literal"><span class="pre">pyderasn.ObjNotReady</span></code></a> exception will be raised.</p>
<p>All objects are friendly to <code class="docutils literal"><span class="pre">copy.copy()</span></code> and copied objects can be
safely mutated.</p>
<p>Also all objects can be safely <code class="docutils literal"><span class="pre">pickle</span></code>-d, but pay attention that
pickling among different PyDERASN versions is prohibited.</p>
</div>
</div>
<div class="section" id="decoding-1">
<span id="decoding"></span><h2><a class="toc-backref" href="#toc-entry-7">Decoding</a><a class="headerlink" href="#decoding-1" title="Permalink to this headline">¶</a></h2>
<p>Decoding is performed using <a class="reference internal" href="#pyderasn.Obj.decode" title="pyderasn.Obj.decode"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decode()</span></code></a> method.
<code class="docutils literal"><span class="pre">offset</span></code> optional argument could be used to set initial object’s
offset in the binary data, for convenience. It returns decoded object
and remaining unmarshalled data (tail). Internally all work is done on
<code class="docutils literal"><span class="pre">memoryview(data)</span></code>, and you can leave returning tail as a memoryview,
by specifying <code class="docutils literal"><span class="pre">leavemm=True</span></code> argument.</p>
<p>Also note convenient <a class="reference internal" href="#pyderasn.Obj.decod" title="pyderasn.Obj.decod"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decod()</span></code></a> method, that
immediately checks and raises if there is non-empty tail.</p>
<p>When object is decoded, <code class="docutils literal"><span class="pre">decoded</span></code> property is true and you can safely
use following properties:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">offset</span></code> – position including initial offset where object’s tag starts</li>
<li><code class="docutils literal"><span class="pre">tlen</span></code> – length of object’s tag</li>
<li><code class="docutils literal"><span class="pre">llen</span></code> – length of object’s length value</li>
<li><code class="docutils literal"><span class="pre">vlen</span></code> – length of object’s value</li>
<li><code class="docutils literal"><span class="pre">tlvlen</span></code> – length of the whole object</li>
</ul>
<p>Pay attention that those values do <strong>not</strong> include anything related to
explicit tag. If you want to know information about it, then use:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">expled</span></code> – to know if explicit tag is set</li>
<li><code class="docutils literal"><span class="pre">expl_offset</span></code> (it is lesser than <code class="docutils literal"><span class="pre">offset</span></code>)</li>
<li><code class="docutils literal"><span class="pre">expl_tlen</span></code>,</li>
<li><code class="docutils literal"><span class="pre">expl_llen</span></code></li>
<li><code class="docutils literal"><span class="pre">expl_vlen</span></code> (that actually equals to ordinary <code class="docutils literal"><span class="pre">tlvlen</span></code>)</li>
<li><code class="docutils literal"><span class="pre">fulloffset</span></code> – it equals to <code class="docutils literal"><span class="pre">expl_offset</span></code> if explicit tag is set,
<code class="docutils literal"><span class="pre">offset</span></code> otherwise</li>
<li><code class="docutils literal"><span class="pre">fulllen</span></code> – it equals to <code class="docutils literal"><span class="pre">expl_len</span></code> if explicit tag is set,
<code class="docutils literal"><span class="pre">tlvlen</span></code> otherwise</li>
</ul>
<p>When error occurs, <a class="reference internal" href="#pyderasn.DecodeError" title="pyderasn.DecodeError"><code class="xref py py-exc docutils literal"><span class="pre">pyderasn.DecodeError</span></code></a> is raised.</p>
<div class="section" id="context">
<span id="ctx"></span><h3><a class="toc-backref" href="#toc-entry-8">Context</a><a class="headerlink" href="#context" title="Permalink to this headline">¶</a></h3>
<p>You can specify so called context keyword argument during
<a class="reference internal" href="#pyderasn.Obj.decode" title="pyderasn.Obj.decode"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decode()</span></code></a> invocation. It is dictionary containing
various options governing decoding process.</p>
<p>Currently available context options:</p>
<ul class="simple">
<li><a class="reference internal" href="#allow-default-values-ctx"><span class="std std-ref">allow_default_values</span></a></li>
<li><a class="reference internal" href="#allow-expl-oob-ctx"><span class="std std-ref">allow_expl_oob</span></a></li>
<li><a class="reference internal" href="#allow-unordered-set-ctx"><span class="std std-ref">allow_unordered_set</span></a></li>
<li><a class="reference internal" href="#bered-ctx"><span class="std std-ref">bered</span></a></li>
<li><a class="reference internal" href="#defines-by-path-ctx"><span class="std std-ref">defines_by_path</span></a></li>
<li><a class="reference internal" href="#evgen-mode-upto-ctx"><span class="std std-ref">evgen_mode_upto</span></a></li>
<li><a class="reference internal" href="#keep-memoryview-ctx"><span class="std std-ref">keep_memoryview</span></a></li>
</ul>
</div>
</div>
<div class="section" id="pretty-printing">
<span id="pprinting"></span><h2><a class="toc-backref" href="#toc-entry-9">Pretty printing</a><a class="headerlink" href="#pretty-printing" title="Permalink to this headline">¶</a></h2>
<p>All objects have <code class="docutils literal"><span class="pre">pps()</span></code> method, that is a generator of
<code class="xref py py-class docutils literal"><span class="pre">pyderasn.PP</span></code> namedtuple, holding various raw information
about the object. If <code class="docutils literal"><span class="pre">pps</span></code> is called on sequences, then all underlying
<code class="docutils literal"><span class="pre">PP</span></code> will be yielded.</p>
<p>You can use <code class="xref py py-func docutils literal"><span class="pre">pyderasn.pp_console_row()</span></code> function, converting
those <code class="docutils literal"><span class="pre">PP</span></code> to human readable string. Actually exactly it is used for
all object <code class="docutils literal"><span class="pre">repr</span></code>. But it is easy to write custom formatters.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pyderasn</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">encoded</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">12345</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="p">,</span> <span class="n">tail</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">encoded</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pprint</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
<span class="go">    0   [1,1,   2] INTEGER -12345</span>
</pre></div>
</div>
<p id="pprint-example">Example certificate:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pprint</span><span class="p">(</span><span class="n">crt</span><span class="p">))</span>
<span class="go">    0   [1,3,1604] Certificate SEQUENCE</span>
<span class="go">    4   [1,3,1453]  . tbsCertificate: TBSCertificate SEQUENCE</span>
<span class="go">   10-2 [1,1,   1]  . . version: [0] EXPLICIT Version INTEGER v3 OPTIONAL</span>
<span class="go">   13   [1,1,   3]  . . serialNumber: CertificateSerialNumber INTEGER 61595</span>
<span class="go">   18   [1,1,  13]  . . signature: AlgorithmIdentifier SEQUENCE</span>
<span class="go">   20   [1,1,   9]  . . . algorithm: OBJECT IDENTIFIER 1.2.840.113549.1.1.5</span>
<span class="go">   31   [0,0,   2]  . . . parameters: [UNIV 5] ANY OPTIONAL</span>
<span class="go">                    . . . . 05:00</span>
<span class="go">   33   [0,0, 278]  . . issuer: Name CHOICE rdnSequence</span>
<span class="go">   33   [1,3, 274]  . . . rdnSequence: RDNSequence SEQUENCE OF</span>
<span class="go">   37   [1,1,  11]  . . . . 0: RelativeDistinguishedName SET OF</span>
<span class="go">   39   [1,1,   9]  . . . . . 0: AttributeTypeAndValue SEQUENCE</span>
<span class="go">   41   [1,1,   3]  . . . . . . type: AttributeType OBJECT IDENTIFIER 2.5.4.6</span>
<span class="go">   46   [0,0,   4]  . . . . . . value: [UNIV 19] AttributeValue ANY</span>
<span class="go">                    . . . . . . . 13:02:45:53</span>
<span class="go">[...]</span>
<span class="go"> 1461   [1,1,  13]  . signatureAlgorithm: AlgorithmIdentifier SEQUENCE</span>
<span class="go"> 1463   [1,1,   9]  . . algorithm: OBJECT IDENTIFIER 1.2.840.113549.1.1.5</span>
<span class="go"> 1474   [0,0,   2]  . . parameters: [UNIV 5] ANY OPTIONAL</span>
<span class="go">                    . . . 05:00</span>
<span class="go"> 1476   [1,2, 129]  . signatureValue: BIT STRING 1024 bits</span>
<span class="go">                    . . 68:EE:79:97:97:DD:3B:EF:16:6A:06:F2:14:9A:6E:CD</span>
<span class="go">                    . . 9E:12:F7:AA:83:10:BD:D1:7C:98:FA:C7:AE:D4:0E:2C</span>
<span class="go"> [...]</span>

<span class="go">Trailing data: 0a</span>
</pre></div>
</div>
<p>Let’s parse that output, human:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">10</span><span class="o">-</span><span class="mi">2</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>   <span class="mi">1</span><span class="p">]</span>    <span class="o">.</span> <span class="o">.</span> <span class="n">version</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="n">EXPLICIT</span> <span class="n">Version</span> <span class="n">INTEGER</span> <span class="n">v3</span> <span class="n">OPTIONAL</span>
<span class="o">^</span>  <span class="o">^</span>  <span class="o">^</span> <span class="o">^</span>    <span class="o">^</span>     <span class="o">^</span>   <span class="o">^</span>        <span class="o">^</span>            <span class="o">^</span>       <span class="o">^</span>       <span class="o">^</span>  <span class="o">^</span>
<span class="mi">0</span>  <span class="mi">1</span>  <span class="mi">2</span> <span class="mi">3</span>    <span class="mi">4</span>     <span class="mi">5</span>   <span class="mi">6</span>        <span class="mi">7</span>            <span class="mi">8</span>       <span class="mi">9</span>       <span class="mi">10</span> <span class="mi">11</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">20</span>   <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>   <span class="mi">9</span><span class="p">]</span>    <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="n">algorithm</span><span class="p">:</span> <span class="n">OBJECT</span> <span class="n">IDENTIFIER</span> <span class="mf">1.2.840.113549.1.1.5</span>
<span class="o">^</span>     <span class="o">^</span> <span class="o">^</span>    <span class="o">^</span>     <span class="o">^</span>     <span class="o">^</span>          <span class="o">^</span>                 <span class="o">^</span>
<span class="mi">0</span>     <span class="mi">2</span> <span class="mi">3</span>    <span class="mi">4</span>     <span class="mi">5</span>     <span class="mi">6</span>          <span class="mi">9</span>                 <span class="mi">10</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">33</span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">278</span><span class="p">]</span>    <span class="o">.</span> <span class="o">.</span> <span class="n">issuer</span><span class="p">:</span> <span class="n">Name</span> <span class="n">CHOICE</span> <span class="n">rdnSequence</span>
<span class="o">^</span>     <span class="o">^</span> <span class="o">^</span>    <span class="o">^</span>     <span class="o">^</span>   <span class="o">^</span>       <span class="o">^</span>    <span class="o">^</span>      <span class="o">^</span>
<span class="mi">0</span>     <span class="mi">2</span> <span class="mi">3</span>    <span class="mi">4</span>     <span class="mi">5</span>   <span class="mi">6</span>       <span class="mi">8</span>    <span class="mi">9</span>      <span class="mi">10</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span>52-2∞ B [1,1,1054]∞  . . . . eContent: [0] EXPLICIT BER OCTET STRING 1046 bytes
      ^           ^                                 ^   ^            ^
     12          13                                14   9            10
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">0:</th><td class="field-body">Offset of the object, where its DER/BER encoding begins.
Pay attention that it does <strong>not</strong> include explicit tag.</td>
</tr>
<tr class="field-even field"><th class="field-name">1:</th><td class="field-body">If explicit tag exists, then this is its length (tag + encoded length).</td>
</tr>
<tr class="field-odd field"><th class="field-name">2:</th><td class="field-body">Length of object’s tag. For example CHOICE does not have its own tag,
so it is zero.</td>
</tr>
<tr class="field-even field"><th class="field-name">3:</th><td class="field-body">Length of encoded length.</td>
</tr>
<tr class="field-odd field"><th class="field-name">4:</th><td class="field-body">Length of encoded value.</td>
</tr>
<tr class="field-even field"><th class="field-name">5:</th><td class="field-body">Visual indentation to show the depth of object in the hierarchy.</td>
</tr>
<tr class="field-odd field"><th class="field-name">6:</th><td class="field-body">Object’s name inside SEQUENCE/CHOICE.</td>
</tr>
<tr class="field-even field"><th class="field-name">7:</th><td class="field-body">If either IMPLICIT or EXPLICIT tag is set, then it will be shown
here. “IMPLICIT” is omitted.</td>
</tr>
<tr class="field-odd field"><th class="field-name">8:</th><td class="field-body">Object’s class name, if set. Omitted if it is just an ordinary simple
value (like with <code class="docutils literal"><span class="pre">algorithm</span></code> in example above).</td>
</tr>
<tr class="field-even field"><th class="field-name">9:</th><td class="field-body">Object’s ASN.1 type.</td>
</tr>
<tr class="field-odd field"><th class="field-name">10:</th><td class="field-body">Object’s value, if set. Can consist of multiple words (like OCTET/BIT
STRINGs above). We see <code class="docutils literal"><span class="pre">v3</span></code> value in Version, because it is named.
<code class="docutils literal"><span class="pre">rdnSequence</span></code> is the choice of CHOICE type.</td>
</tr>
<tr class="field-even field"><th class="field-name">11:</th><td class="field-body">Possible other flags like OPTIONAL and DEFAULT, if value equals to the
default one, specified in the schema.</td>
</tr>
<tr class="field-odd field"><th class="field-name">12:</th><td class="field-body">Shows does object contains any kind of BER encoded data (possibly
Sequence holding BER-encoded underlying value).</td>
</tr>
<tr class="field-even field"><th class="field-name">13:</th><td class="field-body">Only applicable to BER encoded data. Indefinite length encoding mark.</td>
</tr>
<tr class="field-odd field"><th class="field-name">14:</th><td class="field-body">Only applicable to BER encoded data. If object has BER-specific
encoding, then <code class="docutils literal"><span class="pre">BER</span></code> will be shown. It does not depend on indefinite
length encoding. <code class="docutils literal"><span class="pre">EOC</span></code>, <code class="docutils literal"><span class="pre">BOOLEAN</span></code>, <code class="docutils literal"><span class="pre">BIT</span> <span class="pre">STRING</span></code>, <code class="docutils literal"><span class="pre">OCTET</span> <span class="pre">STRING</span></code>
(and its derivatives), <code class="docutils literal"><span class="pre">SET</span></code>, <code class="docutils literal"><span class="pre">SET</span> <span class="pre">OF</span></code>, <code class="docutils literal"><span class="pre">UTCTime</span></code>, <code class="docutils literal"><span class="pre">GeneralizedTime</span></code>
could be BERed.</td>
</tr>
</tbody>
</table>
<p>Also it could be helpful to add quick ASN.1 pprinting command in your
pdb’s configuration file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">alias</span> <span class="n">pp1</span> <span class="kn">import</span> <span class="nn">pyderasn</span> <span class="p">;;</span> <span class="nb">print</span><span class="p">(</span><span class="n">pyderasn</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="o">%</span><span class="mi">1</span><span class="p">,</span> <span class="n">oid_maps</span><span class="o">=</span><span class="p">(</span><span class="nb">locals</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;OID_STR_TO_NAME&quot;</span><span class="p">,</span> <span class="p">{}),)))</span>
</pre></div>
</div>
</div>
<div class="section" id="defined-by">
<span id="definedby"></span><h2><a class="toc-backref" href="#toc-entry-10">DEFINED BY</a><a class="headerlink" href="#defined-by" title="Permalink to this headline">¶</a></h2>
<p>ASN.1 structures often have ANY and OCTET STRING fields, that are
DEFINED BY some previously met ObjectIdentifier. This library provides
ability to specify mapping between some OID and field that must be
decoded with specific specification.</p>
<div class="section" id="defines-kwarg">
<span id="defines"></span><h3><a class="toc-backref" href="#toc-entry-11">defines kwarg</a><a class="headerlink" href="#defines-kwarg" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#pyderasn.ObjectIdentifier" title="pyderasn.ObjectIdentifier"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.ObjectIdentifier</span></code></a> field inside
<a class="reference internal" href="#pyderasn.Sequence" title="pyderasn.Sequence"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Sequence</span></code></a> can hold mapping between OIDs and
necessary for decoding structures. For example, CMS (<span class="target" id="index-0"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc5652.html"><strong>RFC 5652</strong></a>)
container:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ContentInfo</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;contentType&quot;</span><span class="p">,</span> <span class="n">ContentType</span><span class="p">(</span><span class="n">defines</span><span class="o">=</span><span class="p">(((</span><span class="s2">&quot;content&quot;</span><span class="p">,),</span> <span class="p">{</span>
            <span class="n">id_digestedData</span><span class="p">:</span> <span class="n">DigestedData</span><span class="p">(),</span>
            <span class="n">id_signedData</span><span class="p">:</span> <span class="n">SignedData</span><span class="p">(),</span>
        <span class="p">}),))),</span>
        <span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,</span> <span class="n">Any</span><span class="p">(</span><span class="n">expl</span><span class="o">=</span><span class="n">tag_ctxc</span><span class="p">(</span><span class="mi">0</span><span class="p">))),</span>
    <span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">contentType</span></code> field tells that it defines that <code class="docutils literal"><span class="pre">content</span></code> must be
decoded with <code class="docutils literal"><span class="pre">SignedData</span></code> specification, if <code class="docutils literal"><span class="pre">contentType</span></code> equals to
<code class="docutils literal"><span class="pre">id-signedData</span></code>. The same applies to <code class="docutils literal"><span class="pre">DigestedData</span></code>. If
<code class="docutils literal"><span class="pre">contentType</span></code> contains unknown OID, then no automatic decoding is
done.</p>
<p>You can specify multiple fields, that will be autodecoded – that is why
<code class="docutils literal"><span class="pre">defines</span></code> kwarg is a sequence. You can specify defined field
relatively or absolutely to current decode path. For example <code class="docutils literal"><span class="pre">defines</span></code>
for AlgorithmIdentifier of X.509’s
<code class="docutils literal"><span class="pre">tbsCertificate:subjectPublicKeyInfo:algorithm:algorithm</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="p">((</span><span class="s2">&quot;parameters&quot;</span><span class="p">,),</span> <span class="p">{</span>
        <span class="n">id_ecPublicKey</span><span class="p">:</span> <span class="n">ECParameters</span><span class="p">(),</span>
        <span class="n">id_GostR3410_2001</span><span class="p">:</span> <span class="n">GostR34102001PublicKeyParameters</span><span class="p">(),</span>
    <span class="p">}),</span>
    <span class="p">((</span><span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;subjectPublicKey&quot;</span><span class="p">),</span> <span class="p">{</span>
        <span class="n">id_rsaEncryption</span><span class="p">:</span> <span class="n">RSAPublicKey</span><span class="p">(),</span>
        <span class="n">id_GostR3410_2001</span><span class="p">:</span> <span class="n">OctetString</span><span class="p">(),</span>
    <span class="p">}),</span>
<span class="p">),</span>
</pre></div>
</div>
<p>tells that if certificate’s SPKI algorithm is GOST R 34.10-2001, then
autodecode its parameters inside SPKI’s algorithm and its public key
itself.</p>
<p>Following types can be automatically decoded (DEFINED BY):</p>
<ul class="simple">
<li><a class="reference internal" href="#pyderasn.Any" title="pyderasn.Any"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Any</span></code></a></li>
<li><a class="reference internal" href="#pyderasn.BitString" title="pyderasn.BitString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.BitString</span></code></a> (that is multiple of 8 bits)</li>
<li><a class="reference internal" href="#pyderasn.OctetString" title="pyderasn.OctetString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.OctetString</span></code></a></li>
<li><a class="reference internal" href="#pyderasn.SequenceOf" title="pyderasn.SequenceOf"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.SequenceOf</span></code></a>/<a class="reference internal" href="#pyderasn.SetOf" title="pyderasn.SetOf"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.SetOf</span></code></a>
<code class="docutils literal"><span class="pre">Any</span></code>/<code class="docutils literal"><span class="pre">BitString</span></code>/<code class="docutils literal"><span class="pre">OctetString</span></code>-s</li>
</ul>
<p>When any of those fields is automatically decoded, then <code class="docutils literal"><span class="pre">.defined</span></code>
attribute contains <code class="docutils literal"><span class="pre">(OID,</span> <span class="pre">value)</span></code> tuple. <code class="docutils literal"><span class="pre">OID</span></code> tells by which OID it
was defined, <code class="docutils literal"><span class="pre">value</span></code> contains corresponding decoded value. For example
above, <code class="docutils literal"><span class="pre">content_info[&quot;content&quot;].defined</span> <span class="pre">==</span> <span class="pre">(id_signedData,</span> <span class="pre">signed_data)</span></code>.</p>
</div>
<div class="section" id="defines-by-path-context-option">
<span id="defines-by-path-ctx"></span><h3><a class="toc-backref" href="#toc-entry-12">defines_by_path context option</a><a class="headerlink" href="#defines-by-path-context-option" title="Permalink to this headline">¶</a></h3>
<p>Sometimes you either can not or do not want to explicitly set <em>defines</em>
in the schema. You can dynamically apply those definitions when calling
<a class="reference internal" href="#pyderasn.Obj.decode" title="pyderasn.Obj.decode"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decode()</span></code></a> method.</p>
<p>Specify <code class="docutils literal"><span class="pre">defines_by_path</span></code> key in the <a class="reference internal" href="#ctx"><span class="std std-ref">decode context</span></a>. Its
value must be sequence of following tuples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">decode_path</span><span class="p">,</span> <span class="n">defines</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">decode_path</span></code> is a tuple holding so-called decode path to the
exact <a class="reference internal" href="#pyderasn.ObjectIdentifier" title="pyderasn.ObjectIdentifier"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.ObjectIdentifier</span></code></a> field you want to apply
<code class="docutils literal"><span class="pre">defines</span></code>, holding exactly the same value as accepted in its
<a class="reference internal" href="#defines"><span class="std std-ref">keyword argument</span></a>.</p>
<p>For example, again for CMS, you want to automatically decode
<code class="docutils literal"><span class="pre">SignedData</span></code> and CMC’s (<span class="target" id="index-1"></span><a class="rfc reference external" href="https://tools.ietf.org/html/rfc5272.html"><strong>RFC 5272</strong></a>) <code class="docutils literal"><span class="pre">PKIData</span></code> and <code class="docutils literal"><span class="pre">PKIResponse</span></code>
structures it may hold. Also, automatically decode <code class="docutils literal"><span class="pre">controlSequence</span></code>
of <code class="docutils literal"><span class="pre">PKIResponse</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">content_info</span> <span class="o">=</span> <span class="n">ContentInfo</span><span class="p">()</span><span class="o">.</span><span class="n">decod</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;defines_by_path&quot;</span><span class="p">:</span> <span class="p">(</span>
    <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;contentType&quot;</span><span class="p">,),</span>
        <span class="p">(((</span><span class="s2">&quot;content&quot;</span><span class="p">,),</span> <span class="p">{</span><span class="n">id_signedData</span><span class="p">:</span> <span class="n">SignedData</span><span class="p">()}),),</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="p">(</span>
            <span class="s2">&quot;content&quot;</span><span class="p">,</span>
            <span class="n">DecodePathDefBy</span><span class="p">(</span><span class="n">id_signedData</span><span class="p">),</span>
            <span class="s2">&quot;encapContentInfo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;eContentType&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(((</span><span class="s2">&quot;eContent&quot;</span><span class="p">,),</span> <span class="p">{</span>
            <span class="n">id_cct_PKIData</span><span class="p">:</span> <span class="n">PKIData</span><span class="p">(),</span>
            <span class="n">id_cct_PKIResponse</span><span class="p">:</span> <span class="n">PKIResponse</span><span class="p">(),</span>
        <span class="p">})),</span>
    <span class="p">),</span>
    <span class="p">(</span>
        <span class="p">(</span>
            <span class="s2">&quot;content&quot;</span><span class="p">,</span>
            <span class="n">DecodePathDefBy</span><span class="p">(</span><span class="n">id_signedData</span><span class="p">),</span>
            <span class="s2">&quot;encapContentInfo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;eContent&quot;</span><span class="p">,</span>
            <span class="n">DecodePathDefBy</span><span class="p">(</span><span class="n">id_cct_PKIResponse</span><span class="p">),</span>
            <span class="s2">&quot;controlSequence&quot;</span><span class="p">,</span>
            <span class="nb">any</span><span class="p">,</span>
            <span class="s2">&quot;attrType&quot;</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="p">(((</span><span class="s2">&quot;attrValues&quot;</span><span class="p">,),</span> <span class="p">{</span>
            <span class="n">id_cmc_recipientNonce</span><span class="p">:</span> <span class="n">RecipientNonce</span><span class="p">(),</span>
            <span class="n">id_cmc_senderNonce</span><span class="p">:</span> <span class="n">SenderNonce</span><span class="p">(),</span>
            <span class="n">id_cmc_statusInfoV2</span><span class="p">:</span> <span class="n">CMCStatusInfoV2</span><span class="p">(),</span>
            <span class="n">id_cmc_transactionId</span><span class="p">:</span> <span class="n">TransactionId</span><span class="p">(),</span>
        <span class="p">})),</span>
    <span class="p">),</span>
<span class="p">)})</span>
</pre></div>
</div>
<p>Pay attention for <code class="xref py py-class docutils literal"><span class="pre">pyderasn.DecodePathDefBy</span></code> and <code class="docutils literal"><span class="pre">any</span></code>.
First function is useful for path construction when some automatic
decoding is already done. <code class="docutils literal"><span class="pre">any</span></code> means literally any value it meet –
useful for SEQUENCE/SET OF-s.</p>
</div>
</div>
<div class="section" id="ber-encoding">
<span id="bered-ctx"></span><h2><a class="toc-backref" href="#toc-entry-13">BER encoding</a><a class="headerlink" href="#ber-encoding" title="Permalink to this headline">¶</a></h2>
<p>By default PyDERASN accepts only DER encoded data. By default it encodes
to DER. But you can optionally enable BER decoding with setting
<code class="docutils literal"><span class="pre">bered</span></code> <a class="reference internal" href="#ctx"><span class="std std-ref">context</span></a> argument to True. Indefinite lengths and
constructed primitive types should be parsed successfully.</p>
<ul class="simple">
<li>If object is encoded in BER form (not the DER one), then <code class="docutils literal"><span class="pre">ber_encoded</span></code>
attribute is set to True. Only <code class="docutils literal"><span class="pre">BOOLEAN</span></code>, <code class="docutils literal"><span class="pre">BIT</span> <span class="pre">STRING</span></code>, <code class="docutils literal"><span class="pre">OCTET</span>
<span class="pre">STRING</span></code>, <code class="docutils literal"><span class="pre">OBJECT</span> <span class="pre">IDENTIFIER</span></code>, <code class="docutils literal"><span class="pre">SEQUENCE</span></code>, <code class="docutils literal"><span class="pre">SET</span></code>, <code class="docutils literal"><span class="pre">SET</span> <span class="pre">OF</span></code>,
<code class="docutils literal"><span class="pre">UTCTime</span></code>, <code class="docutils literal"><span class="pre">GeneralizedTime</span></code> can contain it.</li>
<li>If object has an indefinite length encoding, then its <code class="docutils literal"><span class="pre">lenindef</span></code>
attribute is set to True. Only <code class="docutils literal"><span class="pre">BIT</span> <span class="pre">STRING</span></code>, <code class="docutils literal"><span class="pre">OCTET</span> <span class="pre">STRING</span></code>,
<code class="docutils literal"><span class="pre">SEQUENCE</span></code>, <code class="docutils literal"><span class="pre">SET</span></code>, <code class="docutils literal"><span class="pre">SEQUENCE</span> <span class="pre">OF</span></code>, <code class="docutils literal"><span class="pre">SET</span> <span class="pre">OF</span></code>, <code class="docutils literal"><span class="pre">ANY</span></code> can
contain it.</li>
<li>If object has an indefinite length encoded explicit tag, then
<code class="docutils literal"><span class="pre">expl_lenindef</span></code> is set to True.</li>
<li>If object has either any of BER-related encoding (explicit tag
indefinite length, object’s indefinite length, BER-encoding) or any
underlying component has that kind of encoding, then <code class="docutils literal"><span class="pre">bered</span></code>
attribute is set to True. For example SignedData CMS can have
<code class="docutils literal"><span class="pre">ContentInfo:content:signerInfos:*</span></code> <code class="docutils literal"><span class="pre">bered</span></code> value set to True, but
<code class="docutils literal"><span class="pre">ContentInfo:content:signerInfos:*:signedAttrs</span></code> won’t.</li>
</ul>
<p>EOC (end-of-contents) token’s length is taken in advance in object’s
value length.</p>
</div>
<div class="section" id="allow-explicit-tag-out-of-bound">
<span id="allow-expl-oob-ctx"></span><h2><a class="toc-backref" href="#toc-entry-14">Allow explicit tag out-of-bound</a><a class="headerlink" href="#allow-explicit-tag-out-of-bound" title="Permalink to this headline">¶</a></h2>
<p>Invalid BER encoding could contain <code class="docutils literal"><span class="pre">EXPLICIT</span></code> tag containing more than
one value, more than one object. If you set <code class="docutils literal"><span class="pre">allow_expl_oob</span></code> context
option to True, then no error will be raised and that invalid encoding
will be silently further processed. But pay attention that offsets and
lengths will be invalid in that case.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This option should be used only for skipping some decode errors, just
to see the decoded structure somehow.</p>
</div>
</div>
<div class="section" id="streaming-and-dealing-with-huge-structures">
<span id="streaming"></span><h2><a class="toc-backref" href="#toc-entry-15">Streaming and dealing with huge structures</a><a class="headerlink" href="#streaming-and-dealing-with-huge-structures" title="Permalink to this headline">¶</a></h2>
<div class="section" id="evgen-mode-1">
<span id="evgen-mode"></span><h3><a class="toc-backref" href="#toc-entry-16">evgen mode</a><a class="headerlink" href="#evgen-mode-1" title="Permalink to this headline">¶</a></h3>
<p>ASN.1 structures can be huge, they can hold millions of objects inside
(for example Certificate Revocation Lists (CRL), holding revocation
state for every previously issued X.509 certificate). CACert.org’s 8 MiB
CRL file takes more than half a gigabyte of memory to hold the decoded
structure.</p>
<p>If you just simply want to check the signature over the <code class="docutils literal"><span class="pre">tbsCertList</span></code>,
you can create specialized schema with that field represented as
OctetString for example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TBSCertListFast</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">[</span><span class="o">...</span><span class="p">]</span>
        <span class="p">(</span><span class="s2">&quot;revokedCertificates&quot;</span><span class="p">,</span> <span class="n">OctetString</span><span class="p">(</span>
            <span class="n">impl</span><span class="o">=</span><span class="n">SequenceOf</span><span class="o">.</span><span class="n">tag_default</span><span class="p">,</span>
            <span class="n">optional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)),</span>
        <span class="p">[</span><span class="o">...</span><span class="p">]</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>This allows you to quickly decode a few fields and check the signature
over the <code class="docutils literal"><span class="pre">tbsCertList</span></code> bytes.</p>
<p>But how can you get all certificate’s serial number from it, after you
trust that CRL after signature validation? You can use so called
<code class="docutils literal"><span class="pre">evgen</span></code> (event generation) mode, to catch the events/facts of some
successful object decoding. Let’s use command line capabilities:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python -m pyderasn --schema tests.test_crl:CertificateList --evgen revoke.crl
     10     [1,1,   1]   . . version: Version INTEGER v2 (01) OPTIONAL
     15     [1,1,   9]   . . . algorithm: OBJECT IDENTIFIER 1.2.840.113549.1.1.13
     26     [0,0,   2]   . . . parameters: [UNIV 5] ANY OPTIONAL
     13     [1,1,  13]   . . signature: AlgorithmIdentifier SEQUENCE
     34     [1,1,   3]   . . . . . . type: AttributeType OBJECT IDENTIFIER 2.5.4.10
     39     [0,0,   9]   . . . . . . value: [UNIV 19] AttributeValue ANY
     32     [1,1,  14]   . . . . . 0: AttributeTypeAndValue SEQUENCE
     30     [1,1,  16]   . . . . 0: RelativeDistinguishedName SET OF
[...]
    188     [1,1,   1]   . . . . userCertificate: CertificateSerialNumber INTEGER 17 (11)
    191     [1,1,  13]   . . . . . utcTime: UTCTime UTCTime 2003-04-01T14:25:08
    191     [0,0,  15]   . . . . revocationDate: Time CHOICE utcTime
    191     [1,1,  13]   . . . . . utcTime: UTCTime UTCTime 2003-04-01T14:25:08
    186     [1,1,  18]   . . . 0: RevokedCertificate SEQUENCE
    208     [1,1,   1]   . . . . userCertificate: CertificateSerialNumber INTEGER 20 (14)
    211     [1,1,  13]   . . . . . utcTime: UTCTime UTCTime 2002-10-01T02:18:01
    211     [0,0,  15]   . . . . revocationDate: Time CHOICE utcTime
    211     [1,1,  13]   . . . . . utcTime: UTCTime UTCTime 2002-10-01T02:18:01
    206     [1,1,  18]   . . . 1: RevokedCertificate SEQUENCE
[...]
9144992     [0,0,  15]   . . . . revocationDate: Time CHOICE utcTime
9144992     [1,1,  13]   . . . . . utcTime: UTCTime UTCTime 2020-02-08T07:25:06
9144985     [1,1,  20]   . . . 415755: RevokedCertificate SEQUENCE
  181     [1,4,9144821]   . . revokedCertificates: RevokedCertificates SEQUENCE OF OPTIONAL
    5     [1,4,9144997]   . tbsCertList: TBSCertList SEQUENCE
9145009     [1,1,   9]   . . algorithm: OBJECT IDENTIFIER 1.2.840.113549.1.1.13
9145020     [0,0,   2]   . . parameters: [UNIV 5] ANY OPTIONAL
9145007     [1,1,  13]   . signatureAlgorithm: AlgorithmIdentifier SEQUENCE
9145022     [1,3, 513]   . signatureValue: BIT STRING 4096 bits
    0     [1,4,9145534]  CertificateList SEQUENCE
</pre></div>
</div>
<p>Here we see how decoder works: it decodes SEQUENCE’s tag, length, then
decodes underlying values. It can not tell if SEQUENCE is decoded, so
the event of the upper level SEQUENCE is the last one we see.
<code class="docutils literal"><span class="pre">version</span></code> field is just a single INTEGER – it is decoded and event is
fired immediately. Then we see that <code class="docutils literal"><span class="pre">algorithm</span></code> and <code class="docutils literal"><span class="pre">parameters</span></code>
fields are decoded and only after them the <code class="docutils literal"><span class="pre">signature</span></code> SEQUENCE is
fired as a successfully decoded. There are 4 events for each revoked
certificate entry in that CRL: <code class="docutils literal"><span class="pre">userCertificate</span></code> serial number,
<code class="docutils literal"><span class="pre">utcTime</span></code> of <code class="docutils literal"><span class="pre">revocationDate</span></code> CHOICE, <code class="docutils literal"><span class="pre">RevokedCertificate</span></code> itself
as a one of entity in <code class="docutils literal"><span class="pre">revokedCertificates</span></code> SEQUENCE OF.</p>
<p>We can do that in our ordinary Python code and understand where we are
by looking at deterministically generated decode paths (do not forget
about useful <code class="docutils literal"><span class="pre">--print-decode-path</span></code> CLI option). We must use
<a class="reference internal" href="#pyderasn.Obj.decode_evgen" title="pyderasn.Obj.decode_evgen"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decode_evgen()</span></code></a> method, instead of ordinary
<a class="reference internal" href="#pyderasn.Obj.decode" title="pyderasn.Obj.decode"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decode()</span></code></a>. It is generator yielding <code class="docutils literal"><span class="pre">(decode_path,</span>
<span class="pre">obj,</span> <span class="pre">tail)</span></code> tuples:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">decode_path</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">CertificateList</span><span class="p">()</span><span class="o">.</span><span class="n">decode_evgen</span><span class="p">(</span><span class="n">crl_raw</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">decode_path</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span>
        <span class="n">decode_path</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;tbsCertList&quot;</span><span class="p">,</span> <span class="s2">&quot;revokedCertificates&quot;</span><span class="p">),</span>
        <span class="n">decode_path</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;userCertificate&quot;</span>
    <span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;serial number:&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
</pre></div>
</div>
<p>Virtually it does not take any memory except at least needed for single
object storage. You can easily use that mode to determine required
object <code class="docutils literal"><span class="pre">.offset</span></code> and <code class="docutils literal"><span class="pre">.*len</span></code> to be able to decode it separately, or
maybe verify signature upon it just by taking bytes by <code class="docutils literal"><span class="pre">.offset</span></code> and
<code class="docutils literal"><span class="pre">.tlvlen</span></code>.</p>
</div>
<div class="section" id="evgen-mode-upto">
<span id="evgen-mode-upto-ctx"></span><h3><a class="toc-backref" href="#toc-entry-17">evgen_mode_upto</a><a class="headerlink" href="#evgen-mode-upto" title="Permalink to this headline">¶</a></h3>
<p>There is full ability to get any kind of data from the CRL in the
example above. However it is not too convenient to get the whole
<code class="docutils literal"><span class="pre">RevokedCertificate</span></code> structure, that is pretty lightweight and one may
do not want to disassemble it. You can use <code class="docutils literal"><span class="pre">evgen_mode_upto</span></code>
<a class="reference internal" href="#ctx"><span class="std std-ref">ctx</span></a> option that semantically equals to
<a class="reference internal" href="#defines-by-path-ctx"><span class="std std-ref">defines_by_path</span></a> – list of decode paths
mapped to any non-None value. If specified decode path is met, then any
subsequent objects won’t be decoded in evgen mode. That allows us to
parse the CRL above with fully assembled <code class="docutils literal"><span class="pre">RevokedCertificate</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">decode_path</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">CertificateList</span><span class="p">()</span><span class="o">.</span><span class="n">decode_evgen</span><span class="p">(</span>
    <span class="n">crl_raw</span><span class="p">,</span>
    <span class="n">ctx</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;evgen_mode_upto&quot;</span><span class="p">:</span> <span class="p">(</span>
        <span class="p">((</span><span class="s2">&quot;tbsCertList&quot;</span><span class="p">,</span> <span class="s2">&quot;revokedCertificates&quot;</span><span class="p">,</span> <span class="nb">any</span><span class="p">),</span> <span class="kc">True</span><span class="p">),</span>
    <span class="p">)},</span>
<span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">decode_path</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span>
        <span class="n">decode_path</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;tbsCertList&quot;</span><span class="p">,</span> <span class="s2">&quot;revokedCertificates&quot;</span><span class="p">),</span>
    <span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;serial number:&quot;</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">obj</span><span class="p">[</span><span class="s2">&quot;userCertificate&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">SEQUENCE/SET values with DEFAULT specified are automatically decoded
without evgen mode.</p>
</div>
</div>
<div class="section" id="mmap-ed-file">
<span id="mmap"></span><h3><a class="toc-backref" href="#toc-entry-18">mmap-ed file</a><a class="headerlink" href="#mmap-ed-file" title="Permalink to this headline">¶</a></h3>
<p>POSIX compliant systems have <code class="docutils literal"><span class="pre">mmap</span></code> syscall, giving ability to work
the memory mapped file. You can deal with the file like it was an
ordinary binary string, allowing you not to load it to the memory first.
Also you can use them as an input for OCTET STRING, taking no Python
memory for their storage.</p>
<p>There is convenient <a class="reference internal" href="#pyderasn.file_mmaped" title="pyderasn.file_mmaped"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.file_mmaped()</span></code></a> function that
creates read-only memoryview on the file contents:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;huge&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
    <span class="n">raw</span> <span class="o">=</span> <span class="n">file_mmaped</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">Something</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">raw</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">mmap maps the <strong>whole</strong> file. So it plays no role if you seek-ed it
before. Take the slice of the resulting memoryview with required
offset instead.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you use ZFS as underlying storage, then pay attention that
currently most platforms does not deal good with ZFS ARC and ordinary
page cache used for mmaps. It can take twice the necessary size in
the memory: both in page cache and ZFS ARC.</p>
</div>
<p id="keep-memoryview-ctx">That read-only memoryview could be safe to be used as a value inside
decoded <a class="reference internal" href="#pyderasn.OctetString" title="pyderasn.OctetString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.OctetString</span></code></a> and <a class="reference internal" href="#pyderasn.Any" title="pyderasn.Any"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Any</span></code></a>
objects. You can enable that by setting <cite>“keep_memoryview”: True</cite> in
<a class="reference internal" href="#ctx"><span class="std std-ref">decode context</span></a>. No OCTET STRING and ANY values will be
copied to memory. Of course that works only in DER encoding, where the
value is continuously encoded.</p>
</div>
<div class="section" id="cer-encoding">
<h3><a class="toc-backref" href="#toc-entry-19">CER encoding</a><a class="headerlink" href="#cer-encoding" title="Permalink to this headline">¶</a></h3>
<p>We can parse any kind of data now, but how can we produce files
streamingly, without storing their encoded representation in memory?
SEQUENCE by default encodes in memory all its values, joins them in huge
binary string, just to know the exact size of SEQUENCE’s value for
encoding it in TLV. DER requires you to know all exact sizes of the
objects.</p>
<p>You can use CER encoding mode, that slightly differs from the DER, but
does not require exact sizes knowledge, allowing streaming encoding
directly to some writer/buffer. Just use
<a class="reference internal" href="#pyderasn.Obj.encode_cer" title="pyderasn.Obj.encode_cer"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.encode_cer()</span></code></a> method, providing the writer where
encoded data will flow:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">encode_cer</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
<span class="n">obj</span><span class="o">.</span><span class="n">encode_cer</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">write</span><span class="p">)</span>
</pre></div>
</div>
<p>If you do not want to create in-memory buffer every time, then you can
use <a class="reference internal" href="#pyderasn.encode_cer" title="pyderasn.encode_cer"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.encode_cer()</span></code></a> function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">encode_cer</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>
</div>
<p>Remember that CER is <strong>not valid</strong> DER in most cases, so you <strong>have to</strong>
use <a class="reference internal" href="#bered-ctx"><span class="std std-ref">bered</span></a> <a class="reference internal" href="#ctx"><span class="std std-ref">ctx</span></a> option during its
decoding. Also currently there is <strong>no</strong> validation that provided CER is
valid one – you are sure that it has only valid BER encoding.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">SET OF values can not be streamingly encoded, because they are
required to be sorted byte-by-byte. Big SET OF values still will take
much memory. Use neither SET nor SET OF values, as modern ASN.1
also recommends too.</p>
</div>
<p>Do not forget about using <a class="reference internal" href="#mmap"><span class="std std-ref">mmap-ed</span></a> memoryviews for your
OCTET STRINGs! They will be streamingly copied from underlying file to
the buffer using 1 KB chunks.</p>
<p>Some structures require that some of the elements have to be forcefully
DER encoded. For example <code class="docutils literal"><span class="pre">SignedData</span></code> CMS requires you to encode
<code class="docutils literal"><span class="pre">SignedAttributes</span></code> and X.509 certificates in DER form, allowing you to
encode everything else in BER. You can tell any of the structures to be
forcefully encoded in DER during CER encoding, by specifying
<code class="docutils literal"><span class="pre">der_forced=True</span></code> attribute:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Certificate</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span><span class="o">...</span><span class="p">)</span>
    <span class="n">der_forced</span> <span class="o">=</span> <span class="kc">True</span>

<span class="k">class</span> <span class="nc">SignedAttributes</span><span class="p">(</span><span class="n">SetOf</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">Attribute</span><span class="p">()</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;+inf&quot;</span><span class="p">))</span>
    <span class="n">der_forced</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
<div class="section" id="agg-octet-string-1">
<span id="agg-octet-string"></span><h3><a class="toc-backref" href="#toc-entry-20">agg_octet_string</a><a class="headerlink" href="#agg-octet-string-1" title="Permalink to this headline">¶</a></h3>
<p>In most cases, huge quantity of binary data is stored as OCTET STRING.
CER encoding splits it on 1 KB chunks. BER allows splitting on various
levels of chunks inclusion:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SOME</span> <span class="n">STRING</span><span class="p">[</span><span class="n">CONSTRUCTED</span><span class="p">]</span>
    <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">CONSTRUCTED</span><span class="p">]</span>
        <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">PRIMITIVE</span><span class="p">]</span>
            <span class="n">DATA</span> <span class="n">CHUNK</span>
        <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">PRIMITIVE</span><span class="p">]</span>
            <span class="n">DATA</span> <span class="n">CHUNK</span>
        <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">PRIMITIVE</span><span class="p">]</span>
            <span class="n">DATA</span> <span class="n">CHUNK</span>
    <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">PRIMITIVE</span><span class="p">]</span>
        <span class="n">DATA</span> <span class="n">CHUNK</span>
    <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">CONSTRUCTED</span><span class="p">]</span>
        <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">PRIMITIVE</span><span class="p">]</span>
            <span class="n">DATA</span> <span class="n">CHUNK</span>
        <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">PRIMITIVE</span><span class="p">]</span>
            <span class="n">DATA</span> <span class="n">CHUNK</span>
    <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">CONSTRUCTED</span><span class="p">]</span>
        <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">CONSTRUCTED</span><span class="p">]</span>
            <span class="n">OCTET</span> <span class="n">STRING</span><span class="p">[</span><span class="n">PRIMITIVE</span><span class="p">]</span>
                <span class="n">DATA</span> <span class="n">CHUNK</span>
</pre></div>
</div>
<p>You can not just take the offset and some <code class="docutils literal"><span class="pre">.vlen</span></code> of the STRING and
treat it as the payload. If you decode it without
<a class="reference internal" href="#evgen-mode"><span class="std std-ref">evgen mode</span></a>, then it will be automatically aggregated
and <code class="docutils literal"><span class="pre">bytes()</span></code> will give the whole payload contents.</p>
<p>You are forced to use <a class="reference internal" href="#evgen-mode"><span class="std std-ref">evgen mode</span></a> for decoding for
small memory footprint. There is convenient
<a class="reference internal" href="#pyderasn.agg_octet_string" title="pyderasn.agg_octet_string"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.agg_octet_string()</span></code></a> helper for reconstructing the
payload. Let’s assume you have got BER/CER encoded <code class="docutils literal"><span class="pre">ContentInfo</span></code> with
huge <code class="docutils literal"><span class="pre">SignedData</span></code> and <code class="docutils literal"><span class="pre">EncapsulatedContentInfo</span></code>. Let’s calculate the
SHA512 digest of its <code class="docutils literal"><span class="pre">eContent</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data.p7m&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span>
<span class="n">raw</span> <span class="o">=</span> <span class="n">file_mmaped</span><span class="p">(</span><span class="n">fd</span><span class="p">)</span>
<span class="n">ctx</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;bered&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
<span class="k">for</span> <span class="n">decode_path</span><span class="p">,</span> <span class="n">obj</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">ContentInfo</span><span class="p">()</span><span class="o">.</span><span class="n">decode_evgen</span><span class="p">(</span><span class="n">raw</span><span class="p">,</span> <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">decode_path</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;content&quot;</span><span class="p">,):</span>
        <span class="n">content</span> <span class="o">=</span> <span class="n">obj</span>
        <span class="k">break</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;no content found&quot;</span><span class="p">)</span>
<span class="n">hasher_state</span> <span class="o">=</span> <span class="n">sha512</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">hasher</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="n">hasher_state</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">evgens</span> <span class="o">=</span> <span class="n">SignedData</span><span class="p">()</span><span class="o">.</span><span class="n">decode_evgen</span><span class="p">(</span>
    <span class="n">raw</span><span class="p">[</span><span class="n">content</span><span class="o">.</span><span class="n">offset</span><span class="p">:],</span>
    <span class="n">offset</span><span class="o">=</span><span class="n">content</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span>
    <span class="n">ctx</span><span class="o">=</span><span class="n">ctx</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">agg_octet_string</span><span class="p">(</span><span class="n">evgens</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;encapContentInfo&quot;</span><span class="p">,</span> <span class="s2">&quot;eContent&quot;</span><span class="p">),</span> <span class="n">raw</span><span class="p">,</span> <span class="n">hasher</span><span class="p">)</span>
<span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">digest</span> <span class="o">=</span> <span class="n">hasher_state</span><span class="o">.</span><span class="n">digest</span><span class="p">()</span>
</pre></div>
</div>
<p>Simply replace <code class="docutils literal"><span class="pre">hasher</span></code> with some writeable file’s <code class="docutils literal"><span class="pre">fd.write</span></code> to
copy the payload (without BER/CER encoding interleaved overhead) in it.
Virtually it won’t take memory more than for keeping small structures
and 1 KB binary chunks.</p>
</div>
<div class="section" id="sequence-of-iterators">
<span id="seqof-iterators"></span><h3><a class="toc-backref" href="#toc-entry-21">SEQUENCE OF iterators</a><a class="headerlink" href="#sequence-of-iterators" title="Permalink to this headline">¶</a></h3>
<p>You can use iterators as a value in <a class="reference internal" href="#pyderasn.SequenceOf" title="pyderasn.SequenceOf"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.SequenceOf</span></code></a>
classes. The only difference with providing the full list of objects, is
that type and bounds checking is done during encoding process. Also
sequence’s value will be emptied after encoding, forcing you to set its
value again.</p>
<p>This is very useful when you have to create some huge objects, like
CRLs, with thousands and millions of entities inside. You can write the
generator taking necessary data from the database and giving the
<code class="docutils literal"><span class="pre">RevokedCertificate</span></code> objects. Only binary representation of that
objects will take memory during DER encoding.</p>
</div>
</div>
<div class="section" id="pass-der-encoding">
<h2><a class="toc-backref" href="#toc-entry-22">2-pass DER encoding</a><a class="headerlink" href="#pass-der-encoding" title="Permalink to this headline">¶</a></h2>
<p>There is ability to do 2-pass encoding to DER, writing results directly
to specified writer (buffer, file, whatever). It could be 1.5+ times
slower than ordinary encoding, but it takes little memory for 1st pass
state storing. For example, 1st pass state for CACert.org’s CRL with
~416K of certificate entries takes nearly 3.5 MB of memory.
<code class="docutils literal"><span class="pre">SignedData</span></code> with several gigabyte <code class="docutils literal"><span class="pre">EncapsulatedContentInfo</span></code> takes
nearly 0.5 KB of memory.</p>
<p>If you use <a class="reference internal" href="#mmap"><span class="std std-ref">mmap-ed</span></a> memoryviews, <a class="reference internal" href="#seqof-iterators"><span class="std std-ref">SEQUENCE OF
iterators</span></a> and write directly to opened file, then
there is very small memory footprint.</p>
<p>1st pass traverses through all the objects of the structure and returns
the size of DER encoded structure, together with 1st pass state object.
That state contains precalculated lengths for various objects inside the
structure.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">fulllen</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">encode1st</span><span class="p">()</span>
</pre></div>
</div>
<p>2nd pass takes the writer and 1st pass state. It traverses through all
the objects again, but writes their encoded representation to the writer.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;result&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fd</span><span class="p">:</span>
    <span class="n">obj</span><span class="o">.</span><span class="n">encode2nd</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">,</span> <span class="nb">iter</span><span class="p">(</span><span class="n">state</span><span class="p">))</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You <strong>MUST NOT</strong> use 1st pass state if anything is changed in the
objects. It is intended to be used immediately after 1st pass is
done!</p>
</div>
<p>If you use <a class="reference internal" href="#seqof-iterators"><span class="std std-ref">SEQUENCE OF iterators</span></a>, then you
have to reinitialize the values after the 1st pass. And you <strong>have to</strong>
be sure that the iterator gives exactly the same values as previously.
Yes, you have to run your iterator twice – because this is two pass
encoding mode.</p>
<p>If you want to encode to the memory, then you can use convenient
<a class="reference internal" href="#pyderasn.encode2pass" title="pyderasn.encode2pass"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.encode2pass()</span></code></a> helper.</p>
</div>
<div class="section" id="asn-1-browser">
<span id="browser"></span><h2><a class="toc-backref" href="#toc-entry-23">ASN.1 browser</a><a class="headerlink" href="#asn-1-browser" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyderasn.browse">
<code class="descclassname">pyderasn.</code><code class="descname">browse</code><span class="sig-paren">(</span><em>raw</em>, <em>obj</em>, <em>oid_maps=()</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.browse" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactive browser</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>raw</strong> (<em>bytes</em>) – binary data you decoded</li>
<li><strong>obj</strong> – decoded <a class="reference internal" href="#pyderasn.Obj" title="pyderasn.Obj"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Obj</span></code></a></li>
<li><strong>oid_maps</strong> – list of <code class="docutils literal"><span class="pre">str(OID)</span> <span class="pre">&lt;-&gt;</span> <span class="pre">human</span> <span class="pre">readable</span> <span class="pre">string</span></code> dictionaries.
Its human readable form is printed when OID is met</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference external" href="http://urwid.org/">urwid</a> dependency required</p>
</div>
<p>This browser is an interactive terminal application for browsing
structures of your decoded ASN.1 objects. You can quit it with <strong>q</strong>
key. It consists of three windows:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Tree:</th><td class="field-body">View of ASN.1 elements hierarchy. You can navigate it using <strong>Up</strong>,
<strong>Down</strong>, <strong>PageUp</strong>, <strong>PageDown</strong>, <strong>Home</strong>, <strong>End</strong> keys.
<strong>Left</strong> key goes to constructed element above. <strong>Plus</strong>/<strong>Minus</strong>
keys collapse/uncollapse constructed elements. <strong>Space</strong> toggles it</td>
</tr>
<tr class="field-even field"><th class="field-name">Info:</th><td class="field-body">window with various information about element. You can scroll it
with <strong>h</strong>/<strong>l</strong> (down, up) (<strong>H</strong>/<strong>L</strong> for triple speed) keys</td>
</tr>
<tr class="field-odd field"><th class="field-name">Hexdump:</th><td class="field-body">window with raw data hexdump and highlighted current element’s
contents. It automatically focuses on element’s data. You can
scroll it with <strong>j</strong>/<strong>k</strong> (down, up) (<strong>J</strong>/<strong>K</strong> for triple
speed) keys. If element has explicit tag, then it also will be
highlighted with different colour</td>
</tr>
</tbody>
</table>
<p>Window’s header contains current decode path and progress bars with
position in <em>info</em> and <em>hexdump</em> windows.</p>
<p>If you press <strong>d</strong>, then current element will be saved in the
current directory under its decode path name (adding “.0”, “.1”, etc
suffix if such file already exists). <strong>D</strong> will save it with explicit tag.</p>
<p>You can also invoke it with <code class="docutils literal"><span class="pre">--browse</span></code> command line argument.</p>
</dd></dl>

</div>
<div class="section" id="base-obj">
<h2><a class="toc-backref" href="#toc-entry-24">Base Obj</a><a class="headerlink" href="#base-obj" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="pyderasn.Obj">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Obj</code><span class="sig-paren">(</span><em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj" title="Permalink to this definition">¶</a></dt>
<dd><p>Common ASN.1 object class</p>
<p>All ASN.1 types are inherited from it. It has metaclass that
automatically adds <code class="docutils literal"><span class="pre">__slots__</span></code> to all inherited classes.</p>
<dl class="attribute">
<dt id="pyderasn.Obj.bered">
<code class="descname">bered</code><a class="headerlink" href="#pyderasn.Obj.bered" title="Permalink to this definition">¶</a></dt>
<dd><p>Is either object or any elements inside is BER encoded?</p>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.decod">
<code class="descname">decod</code><span class="sig-paren">(</span><em>data</em>, <em>offset=0</em>, <em>decode_path=()</em>, <em>ctx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.decod" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode the data, check that tail is empty</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><a class="reference internal" href="#pyderasn.ExceedingData" title="pyderasn.ExceedingData"><strong>ExceedingData</strong></a> – if tail is not empty</td>
</tr>
</tbody>
</table>
<p>This is just a wrapper over <a class="reference internal" href="#pyderasn.Obj.decode" title="pyderasn.Obj.decode"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decode()</span></code></a>
(decode without tail) that also checks that there is no
trailing data left.</p>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.decode">
<code class="descname">decode</code><span class="sig-paren">(</span><em>data</em>, <em>offset=0</em>, <em>leavemm=False</em>, <em>decode_path=()</em>, <em>ctx=None</em>, <em>tag_only=False</em>, <em>_ctx_immutable=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode the data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> – either binary or memoryview</li>
<li><strong>offset</strong> (<em>int</em>) – initial data’s offset</li>
<li><strong>leavemm</strong> (<em>bool</em>) – do we need to leave memoryview of remaining
data as is, or convert it to bytes otherwise</li>
<li><strong>decode_path</strong> – current decode path (tuples of strings,
possibly with DecodePathDefBy) with will be
the root for all underlying objects</li>
<li><strong>ctx</strong> – optional <a class="reference internal" href="#ctx"><span class="std std-ref">context</span></a> governing decoding process</li>
<li><strong>tag_only</strong> (<em>bool</em>) – decode only the tag, without length and
contents (used only in Choice and Set
structures, trying to determine if tag satisfies
the schema)</li>
<li><strong>_ctx_immutable</strong> (<em>bool</em>) – do we need to <code class="docutils literal"><span class="pre">copy.copy()</span></code> <code class="docutils literal"><span class="pre">ctx</span></code>
before using it?</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(Obj, remaining data)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.decode_evgen">
<code class="descname">decode_evgen</code><span class="sig-paren">(</span><em>data</em>, <em>offset=0</em>, <em>leavemm=False</em>, <em>decode_path=()</em>, <em>ctx=None</em>, <em>tag_only=False</em>, <em>_ctx_immutable=True</em>, <em>_evgen_mode=True</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.decode_evgen" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode with evgen mode on</p>
<p>That method is identical to <a class="reference internal" href="#pyderasn.Obj.decode" title="pyderasn.Obj.decode"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decode()</span></code></a>, but
it returns the generator producing <code class="docutils literal"><span class="pre">(decode_path,</span> <span class="pre">obj,</span> <span class="pre">tail)</span></code>
values.
.. seealso:: <a class="reference internal" href="#evgen-mode"><span class="std std-ref">evgen mode</span></a>.</p>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.decoded">
<code class="descname">decoded</code><a class="headerlink" href="#pyderasn.Obj.decoded" title="Permalink to this definition">¶</a></dt>
<dd><p>Is object decoded?</p>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.encode">
<code class="descname">encode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.encode" title="Permalink to this definition">¶</a></dt>
<dd><p>DER encode the structure</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">DER representation</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.encode1st">
<code class="descname">encode1st</code><span class="sig-paren">(</span><em>state=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.encode1st" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the 1st pass of 2-pass encoding</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">(int, array(“L”))</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">full length of encoded data and precalculated various
objects lengths</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.encode2nd">
<code class="descname">encode2nd</code><span class="sig-paren">(</span><em>writer</em>, <em>state_iter</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.encode2nd" title="Permalink to this definition">¶</a></dt>
<dd><p>Do the 2nd pass of 2-pass encoding</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>writer</strong> – must comply with <code class="docutils literal"><span class="pre">io.RawIOBase.write</span></code> behaviour</li>
<li><strong>state_iter</strong> – iterator over the 1st pass state (<code class="docutils literal"><span class="pre">iter(state)</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.encode_cer">
<code class="descname">encode_cer</code><span class="sig-paren">(</span><em>writer</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.encode_cer" title="Permalink to this definition">¶</a></dt>
<dd><p>CER encode the structure to specified writer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>writer</strong> – must comply with <code class="docutils literal"><span class="pre">io.RawIOBase.write</span></code>
behaviour. It takes slice to be written and
returns number of bytes processed. If it returns
None, then exception will be raised</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.expl_llen">
<code class="descname">expl_llen</code><a class="headerlink" href="#pyderasn.Obj.expl_llen" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.expl_offset">
<code class="descname">expl_offset</code><a class="headerlink" href="#pyderasn.Obj.expl_offset" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.expl_tag">
<code class="descname">expl_tag</code><a class="headerlink" href="#pyderasn.Obj.expl_tag" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.expl_tlen">
<code class="descname">expl_tlen</code><a class="headerlink" href="#pyderasn.Obj.expl_tlen" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.expl_tlvlen">
<code class="descname">expl_tlvlen</code><a class="headerlink" href="#pyderasn.Obj.expl_tlvlen" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.expl_vlen">
<code class="descname">expl_vlen</code><a class="headerlink" href="#pyderasn.Obj.expl_vlen" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.expled">
<code class="descname">expled</code><a class="headerlink" href="#pyderasn.Obj.expled" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.fulllen">
<code class="descname">fulllen</code><a class="headerlink" href="#pyderasn.Obj.fulllen" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.fulloffset">
<code class="descname">fulloffset</code><a class="headerlink" href="#pyderasn.Obj.fulloffset" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.hexdecod">
<code class="descname">hexdecod</code><span class="sig-paren">(</span><em>data</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.hexdecod" title="Permalink to this definition">¶</a></dt>
<dd><p>Do <a class="reference internal" href="#pyderasn.Obj.decod" title="pyderasn.Obj.decod"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decod()</span></code></a> with hexadecimal decoded data</p>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.hexdecode">
<code class="descname">hexdecode</code><span class="sig-paren">(</span><em>data</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.hexdecode" title="Permalink to this definition">¶</a></dt>
<dd><p>Do <a class="reference internal" href="#pyderasn.Obj.decode" title="pyderasn.Obj.decode"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.decode()</span></code></a> with hexadecimal decoded data</p>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Obj.hexencode">
<code class="descname">hexencode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Obj.hexencode" title="Permalink to this definition">¶</a></dt>
<dd><p>Do hexadecimal encoded <a class="reference internal" href="#pyderasn.Obj.encode" title="pyderasn.Obj.encode"><code class="xref py py-meth docutils literal"><span class="pre">pyderasn.Obj.encode()</span></code></a></p>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.ready">
<code class="descname">ready</code><a class="headerlink" href="#pyderasn.Obj.ready" title="Permalink to this definition">¶</a></dt>
<dd><p>Is object ready to be encoded?</p>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.tag_order">
<code class="descname">tag_order</code><a class="headerlink" href="#pyderasn.Obj.tag_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Tag’s (class, number) used for DER/CER sorting</p>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.tlen">
<code class="descname">tlen</code><a class="headerlink" href="#pyderasn.Obj.tlen" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Obj.tlvlen">
<code class="descname">tlvlen</code><a class="headerlink" href="#pyderasn.Obj.tlvlen" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#decoding"><span class="std std-ref">Decoding</span></a></p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="primitive-types">
<h2><a class="toc-backref" href="#toc-entry-25">Primitive types</a><a class="headerlink" href="#primitive-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="boolean">
<h3><a class="toc-backref" href="#toc-entry-26">Boolean</a><a class="headerlink" href="#boolean" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.Boolean">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Boolean</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Boolean" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">BOOLEAN</span></code> boolean type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Boolean</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">BOOLEAN True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">==</span> <span class="n">Boolean</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyderasn.Boolean.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Boolean.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either boolean type, or
<a class="reference internal" href="#pyderasn.Boolean" title="pyderasn.Boolean"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Boolean</span></code></a> object</li>
<li><strong>impl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">IMPLICIT</span></code> one</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>default</strong> – set default value. Type same as in <code class="docutils literal"><span class="pre">value</span></code></li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="integer">
<h3><a class="toc-backref" href="#toc-entry-27">Integer</a><a class="headerlink" href="#integer" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.Integer">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Integer</code><span class="sig-paren">(</span><em>value=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_specs=None</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Integer" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">INTEGER</span></code> integer type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">123</span><span class="p">)</span>
<span class="go">INTEGER -123</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">==</span> <span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">123</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">-123</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Integer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">INTEGER 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Integer</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">pyderasn.BoundsError</span>: <span class="n">unsatisfied bounds: 1 &lt;= 5 &lt;= 3</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Version</span><span class="p">(</span><span class="n">Integer</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;v1&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;v2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;v3&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="s2">&quot;v1&quot;</span><span class="p">)</span>
<span class="go">Version INTEGER v1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">named</span>
<span class="go">&#39;v1&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="o">.</span><span class="n">specs</span>
<span class="go">{&#39;v3&#39;: 2, &#39;v1&#39;: 0, &#39;v2&#39;: 1}</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyderasn.Integer.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_specs=None</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Integer.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either integer type, named value
(if <code class="docutils literal"><span class="pre">schema</span></code> is specified in the class), or
<a class="reference internal" href="#pyderasn.Integer" title="pyderasn.Integer"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Integer</span></code></a> object</li>
<li><strong>bounds</strong> – set <code class="docutils literal"><span class="pre">(MIN,</span> <span class="pre">MAX)</span></code> value constraint.
(-inf, +inf) by default</li>
<li><strong>impl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">IMPLICIT</span></code> one</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>default</strong> – set default value. Type same as in <code class="docutils literal"><span class="pre">value</span></code></li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Integer.named">
<code class="descname">named</code><a class="headerlink" href="#pyderasn.Integer.named" title="Permalink to this definition">¶</a></dt>
<dd><p>Return named representation (if exists) of the value</p>
</dd></dl>

<dl class="method">
<dt id="pyderasn.Integer.tohex">
<code class="descname">tohex</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Integer.tohex" title="Permalink to this definition">¶</a></dt>
<dd><p>Hexadecimal representation</p>
<p>Use <a class="reference internal" href="#pyderasn.colonize_hex" title="pyderasn.colonize_hex"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.colonize_hex()</span></code></a> for colonizing it.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="bitstring">
<h3><a class="toc-backref" href="#toc-entry-28">BitString</a><a class="headerlink" href="#bitstring" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.BitString">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">BitString</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_specs=None</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.BitString" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">BIT</span> <span class="pre">STRING</span></code> bit string type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">BitString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;hello world&quot;</span><span class="p">)</span>
<span class="go">BIT STRING 88 bits 68656c6c6f20776f726c64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="go">b&#39;hello world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">==</span> <span class="sa">b</span><span class="s2">&quot;hello world&quot;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">bit_len</span>
<span class="go">88</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">BitString</span><span class="p">(</span><span class="s2">&quot;&#39;0A3B5F291CD&#39;H&quot;</span><span class="p">)</span>
<span class="go">BIT STRING 44 bits 0a3b5f291cd0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">BitString</span><span class="p">(</span><span class="s2">&quot;&#39;010110000000&#39;B&quot;</span><span class="p">)</span>
<span class="go">BIT STRING 12 bits 5800</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">bit_len</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">b</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="go">(False, True, False, True)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">1000</span><span class="p">]</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">b</span><span class="p">]</span>
<span class="go">[False, True, False, True, True, False, False, False, False, False, False, False]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">KeyUsage</span><span class="p">(</span><span class="n">BitString</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;digitalSignature&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;nonRepudiation&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="p">(</span><span class="s2">&quot;keyEncipherment&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">KeyUsage</span><span class="p">((</span><span class="s2">&quot;keyEncipherment&quot;</span><span class="p">,</span> <span class="s2">&quot;nonRepudiation&quot;</span><span class="p">))</span>
<span class="go">KeyUsage BIT STRING 3 bits nonRepudiation, keyEncipherment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">named</span>
<span class="go">[&#39;nonRepudiation&#39;, &#39;keyEncipherment&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">specs</span>
<span class="go">{&#39;nonRepudiation&#39;: 1, &#39;digitalSignature&#39;: 0, &#39;keyEncipherment&#39;: 2}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Pay attention that BIT STRING can be encoded both in primitive
and constructed forms. Decoder always checks constructed form tag
additionally to specified primitive one. If BER decoding is
<a class="reference internal" href="#bered-ctx"><span class="std std-ref">not enabled</span></a>, then decoder will fail, because
of DER restrictions.</p>
</div>
<dl class="method">
<dt id="pyderasn.BitString.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_specs=None</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.BitString.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either binary type, tuple of named
values (if <code class="docutils literal"><span class="pre">schema</span></code> is specified in the class),
string in <code class="docutils literal"><span class="pre">'XXX...'B</span></code> form, or
<a class="reference internal" href="#pyderasn.BitString" title="pyderasn.BitString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.BitString</span></code></a> object</li>
<li><strong>impl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">IMPLICIT</span></code> one</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>default</strong> – set default value. Type same as in <code class="docutils literal"><span class="pre">value</span></code></li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.BitString.bit_len">
<code class="descname">bit_len</code><a class="headerlink" href="#pyderasn.BitString.bit_len" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of bits in the string</p>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.BitString.named">
<code class="descname">named</code><a class="headerlink" href="#pyderasn.BitString.named" title="Permalink to this definition">¶</a></dt>
<dd><p>Named representation (if exists) of the bits</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">[str(name), …]</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="octetstring">
<h3><a class="toc-backref" href="#toc-entry-29">OctetString</a><a class="headerlink" href="#octetstring" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.OctetString">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">OctetString</code><span class="sig-paren">(</span><em>value=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>ctx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.OctetString" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">OCTET</span> <span class="pre">STRING</span></code> binary string type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">OctetString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;hello world&quot;</span><span class="p">)</span>
<span class="go">OCTET STRING 11 bytes 68656c6c6f20776f726c64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">==</span> <span class="n">OctetString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;hello world&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">b&#39;hello world&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">OctetString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;hello&quot;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">pyderasn.BoundsError</span>: <span class="n">unsatisfied bounds: 4 &lt;= 5 &lt;= 4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">OctetString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;hell&quot;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="go">OCTET STRING 4 bytes 68656c6c</span>
</pre></div>
</div>
<p>Memoryviews can be used as a values. If memoryview is made on
mmap-ed file, then it does not take storage inside OctetString
itself. In CER encoding mode it will be streamed to the specified
writer, copying 1 KB chunks.</p>
<dl class="method">
<dt id="pyderasn.OctetString.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>ctx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.OctetString.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either binary type, or
<a class="reference internal" href="#pyderasn.OctetString" title="pyderasn.OctetString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.OctetString</span></code></a> object</li>
<li><strong>bounds</strong> – set <code class="docutils literal"><span class="pre">(MIN,</span> <span class="pre">MAX)</span></code> value size constraint.
(-inf, +inf) by default</li>
<li><strong>impl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">IMPLICIT</span></code> one</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>default</strong> – set default value. Type same as in <code class="docutils literal"><span class="pre">value</span></code></li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="null">
<h3><a class="toc-backref" href="#toc-entry-30">Null</a><a class="headerlink" href="#null" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.Null">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Null</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Null" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">NULL</span></code> null object</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">Null</span><span class="p">()</span>
<span class="go">NULL</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">.</span><span class="n">ready</span>
<span class="go">True</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyderasn.Null.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Null.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>impl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">IMPLICIT</span></code> one</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="objectidentifier">
<h3><a class="toc-backref" href="#toc-entry-31">ObjectIdentifier</a><a class="headerlink" href="#objectidentifier" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.ObjectIdentifier">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">ObjectIdentifier</code><span class="sig-paren">(</span><em>value=None</em>, <em>defines=()</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.ObjectIdentifier" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">OBJECT</span> <span class="pre">IDENTIFIER</span></code> OID type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">oid</span> <span class="o">=</span> <span class="n">ObjectIdentifier</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="go">OBJECT IDENTIFIER 1.2.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oid</span> <span class="o">==</span> <span class="n">ObjectIdentifier</span><span class="p">(</span><span class="s2">&quot;1.2.3&quot;</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">tuple</span><span class="p">(</span><span class="n">oid</span><span class="p">)</span>
<span class="go">(1, 2, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">oid</span><span class="p">)</span>
<span class="go">&#39;1.2.3&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">oid</span> <span class="o">+</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">ObjectIdentifier</span><span class="p">(</span><span class="s2">&quot;1.7&quot;</span><span class="p">)</span>
<span class="go">OBJECT IDENTIFIER 1.2.3.4.5.1.7</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ObjectIdentifier</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">pyderasn.InvalidOID</span>: <span class="n">unacceptable first arc value</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyderasn.ObjectIdentifier.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>defines=()</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.ObjectIdentifier.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either tuples of integers,
string of “.”-concatenated integers, or
<a class="reference internal" href="#pyderasn.ObjectIdentifier" title="pyderasn.ObjectIdentifier"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.ObjectIdentifier</span></code></a> object</li>
<li><strong>defines</strong> – <p>sequence of tuples. Each tuple has two elements.
First one is relative to current one decode
path, aiming to the field defined by that OID.
Read about relative path in
<a class="reference internal" href="#pyderasn.abs_decode_path" title="pyderasn.abs_decode_path"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.abs_decode_path()</span></code></a>. Second
tuple element is <code class="docutils literal"><span class="pre">{OID:</span> <span class="pre">pyderasn.Obj()}</span></code>
dictionary, mapping between current OID value
and structure applied to defined field.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#definedby"><span class="std std-ref">DEFINED BY</span></a></p>
</div>
</li>
<li><strong>impl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">IMPLICIT</span></code> one</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>default</strong> – set default value. Type same as in <code class="docutils literal"><span class="pre">value</span></code></li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="enumerated">
<h3><a class="toc-backref" href="#toc-entry-32">Enumerated</a><a class="headerlink" href="#enumerated" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.Enumerated">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Enumerated</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_specs=None</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>bounds=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Enumerated" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">ENUMERATED</span></code> integer type</p>
<p>This type is identical to <a class="reference internal" href="#pyderasn.Integer" title="pyderasn.Integer"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Integer</span></code></a>, but requires
schema to be specified and does not accept values missing from it.</p>
</dd></dl>

</div>
<div class="section" id="commonstring">
<h3><a class="toc-backref" href="#toc-entry-33">CommonString</a><a class="headerlink" href="#commonstring" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.CommonString">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">CommonString</code><span class="sig-paren">(</span><em>value=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>ctx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.CommonString" title="Permalink to this definition">¶</a></dt>
<dd><p>Common class for all strings</p>
<p>Everything resembles <a class="reference internal" href="#pyderasn.OctetString" title="pyderasn.OctetString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.OctetString</span></code></a>, except
ability to deal with unicode text strings.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hexenc</span><span class="p">(</span><span class="s2">&quot;привет мир&quot;</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">))</span>
<span class="go">&#39;d0bfd180d0b8d0b2d0b5d18220d0bcd0b8d180&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">UTF8String</span><span class="p">(</span><span class="s2">&quot;привет мир&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="n">UTF8String</span><span class="p">(</span><span class="n">hexdec</span><span class="p">(</span><span class="s2">&quot;d0...80&quot;</span><span class="p">))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">UTF8String</span><span class="p">(</span><span class="s2">&quot;привет мир&quot;</span><span class="p">)</span>
<span class="go">UTF8String UTF8String привет мир</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">&#39;привет мир&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hexenc</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">&#39;d0bfd180d0b8d0b2d0b5d18220d0bcd0b8d180&#39;</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">PrintableString</span><span class="p">(</span><span class="s2">&quot;привет мир&quot;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">pyderasn.DecodeError</span>: <span class="n">&#39;ascii&#39; codec can&#39;t encode characters in position 0-5: ordinal not in range(128)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">BMPString</span><span class="p">(</span><span class="s2">&quot;ада&quot;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">pyderasn.BoundsError</span>: <span class="n">unsatisfied bounds: 2 &lt;= 3 &lt;= 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">BMPString</span><span class="p">(</span><span class="s2">&quot;ад&quot;</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">encoding</span>
<span class="go">&#39;utf-16-be&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hexenc</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
<span class="go">&#39;04300434&#39;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Class</th>
<th class="head">Text Encoding, validation</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="xref py py-class docutils literal"><span class="pre">pyderasn.UTF8String</span></code></td>
<td>utf-8</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#pyderasn.NumericString" title="pyderasn.NumericString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.NumericString</span></code></a></td>
<td>proper alphabet validation</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyderasn.PrintableString" title="pyderasn.PrintableString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.PrintableString</span></code></a></td>
<td>proper alphabet validation</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-class docutils literal"><span class="pre">pyderasn.TeletexString</span></code></td>
<td>iso-8859-1</td>
</tr>
<tr class="row-even"><td><code class="xref py py-class docutils literal"><span class="pre">pyderasn.T61String</span></code></td>
<td>iso-8859-1</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-class docutils literal"><span class="pre">pyderasn.VideotexString</span></code></td>
<td>iso-8859-1</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyderasn.IA5String" title="pyderasn.IA5String"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.IA5String</span></code></a></td>
<td>proper alphabet validation</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-class docutils literal"><span class="pre">pyderasn.GraphicString</span></code></td>
<td>iso-8859-1</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#pyderasn.VisibleString" title="pyderasn.VisibleString"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.VisibleString</span></code></a>, <code class="xref py py-class docutils literal"><span class="pre">pyderasn.ISO646String</span></code></td>
<td>proper alphabet validation</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-class docutils literal"><span class="pre">pyderasn.GeneralString</span></code></td>
<td>iso-8859-1</td>
</tr>
<tr class="row-even"><td><code class="xref py py-class docutils literal"><span class="pre">pyderasn.UniversalString</span></code></td>
<td>utf-32-be</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-class docutils literal"><span class="pre">pyderasn.BMPString</span></code></td>
<td>utf-16-be</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="numericstring">
<h3><a class="toc-backref" href="#toc-entry-34">NumericString</a><a class="headerlink" href="#numericstring" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.NumericString">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">NumericString</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.NumericString" title="Permalink to this definition">¶</a></dt>
<dd><p>Numeric string</p>
<p>Its value is properly sanitized: only ASCII digits with spaces can
be stored.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">NumericString</span><span class="p">()</span><span class="o">.</span><span class="n">allowable_chars</span>
<span class="go">frozenset([&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39; &#39;])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="printablestring">
<h3><a class="toc-backref" href="#toc-entry-35">PrintableString</a><a class="headerlink" href="#printablestring" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.PrintableString">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">PrintableString</code><span class="sig-paren">(</span><em>value=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>ctx=None</em>, <em>allow_asterisk=False</em>, <em>allow_ampersand=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.PrintableString" title="Permalink to this definition">¶</a></dt>
<dd><p>Printable string</p>
<p>Its value is properly sanitized: see X.680 41.4 table 10.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">PrintableString</span><span class="p">()</span><span class="o">.</span><span class="n">allowable_chars</span>
<span class="go">frozenset([&#39; &#39;, &quot;&#39;&quot;, ..., &#39;z&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">PrintableString</span><span class="p">(</span><span class="s2">&quot;foo*bar&quot;</span><span class="p">,</span> <span class="n">allow_asterisk</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">PrintableString PrintableString foo*bar</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">allow_asterisk</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">allow_ampersand</span>
<span class="go">(True, False)</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyderasn.PrintableString.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>ctx=None</em>, <em>allow_asterisk=False</em>, <em>allow_ampersand=False</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.PrintableString.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>allow_asterisk</strong> – allow asterisk character</li>
<li><strong>allow_ampersand</strong> – allow ampersand character</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.PrintableString.allow_ampersand">
<code class="descname">allow_ampersand</code><a class="headerlink" href="#pyderasn.PrintableString.allow_ampersand" title="Permalink to this definition">¶</a></dt>
<dd><p>Is ampersand character allowed?</p>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.PrintableString.allow_asterisk">
<code class="descname">allow_asterisk</code><a class="headerlink" href="#pyderasn.PrintableString.allow_asterisk" title="Permalink to this definition">¶</a></dt>
<dd><p>Is asterisk character allowed?</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="ia5string">
<h3><a class="toc-backref" href="#toc-entry-36">IA5String</a><a class="headerlink" href="#ia5string" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.IA5String">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">IA5String</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.IA5String" title="Permalink to this definition">¶</a></dt>
<dd><p>IA5 string</p>
<p>Its value is properly sanitized: it is a mix of</p>
<ul class="simple">
<li><a class="reference external" href="http://www.itscj.ipsj.or.jp/iso-ir/006.pdf">http://www.itscj.ipsj.or.jp/iso-ir/006.pdf</a> (G)</li>
<li><a class="reference external" href="http://www.itscj.ipsj.or.jp/iso-ir/001.pdf">http://www.itscj.ipsj.or.jp/iso-ir/001.pdf</a> (C0)</li>
<li>DEL character (0x7F)</li>
</ul>
<p>It is just 7-bit ASCII.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">IA5String</span><span class="p">()</span><span class="o">.</span><span class="n">allowable_chars</span>
<span class="go">frozenset([&quot;NUL&quot;, ... &quot;DEL&quot;])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="visiblestring">
<h3><a class="toc-backref" href="#toc-entry-37">VisibleString</a><a class="headerlink" href="#visiblestring" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.VisibleString">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">VisibleString</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.VisibleString" title="Permalink to this definition">¶</a></dt>
<dd><p>Visible string</p>
<p>Its value is properly sanitized. ASCII subset from space to tilde is
allowed: <a class="reference external" href="http://www.itscj.ipsj.or.jp/iso-ir/006.pdf">http://www.itscj.ipsj.or.jp/iso-ir/006.pdf</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">VisibleString</span><span class="p">()</span><span class="o">.</span><span class="n">allowable_chars</span>
<span class="go">frozenset([&quot; &quot;, ... &quot;~&quot;])</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="utctime">
<h3><a class="toc-backref" href="#toc-entry-38">UTCTime</a><a class="headerlink" href="#utctime" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.UTCTime">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">UTCTime</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>bounds=None</em>, <em>ctx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.UTCTime" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">UTCTime</span></code> datetime type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">UTCTime</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">123</span><span class="p">))</span>
<span class="go">UTCTime UTCTime 2017-09-30T22:07:50</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">&#39;170930220750Z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bytes</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">b&#39;170930220750Z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">todatetime</span><span class="p">()</span>
<span class="go">datetime.datetime(2017, 9, 30, 22, 7, 50)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">UTCTime</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2057</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span><span class="o">.</span><span class="n">todatetime</span><span class="p">()</span>
<span class="go">datetime.datetime(1957, 9, 30, 22, 7, 50)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">UTCTime</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2057</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span><span class="o">.</span><span class="n">totzdatetime</span><span class="p">()</span>
<span class="go">datetime.datetime(1957, 9, 30, 22, 7, 50, tzinfo=tzutc())</span>
</pre></div>
</div>
<p>If BER encoded value was met, then <code class="docutils literal"><span class="pre">ber_raw</span></code> attribute will hold
its raw representation.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Only <strong>naive</strong> <code class="docutils literal"><span class="pre">datetime</span></code> objects are supported.
Library assumes that all work is done in UTC.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Pay attention that <code class="docutils literal"><span class="pre">UTCTime</span></code> can not hold full year, so all years
having &lt; 50 years are treated as 20xx, 19xx otherwise, according to
X.509 recommendation. Use <code class="docutils literal"><span class="pre">GeneralizedTime</span></code> instead for
removing ambiguity.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>No strict validation of UTC offsets are made (only applicable to
<strong>BER</strong>), but very crude:</p>
<ul class="last simple">
<li>minutes are not exceeding 60</li>
<li>offset value is not exceeding 14 hours</li>
</ul>
</div>
<dl class="method">
<dt id="pyderasn.UTCTime.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>bounds=None</em>, <em>ctx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.UTCTime.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either datetime type, or
<a class="reference internal" href="#pyderasn.UTCTime" title="pyderasn.UTCTime"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.UTCTime</span></code></a> object</li>
<li><strong>impl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">IMPLICIT</span></code> one</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>default</strong> – set default value. Type same as in <code class="docutils literal"><span class="pre">value</span></code></li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="generalizedtime">
<h3><a class="toc-backref" href="#toc-entry-39">GeneralizedTime</a><a class="headerlink" href="#generalizedtime" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.GeneralizedTime">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">GeneralizedTime</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>bounds=None</em>, <em>ctx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.GeneralizedTime" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">GeneralizedTime</span></code> datetime type</p>
<p>This type is similar to <a class="reference internal" href="#pyderasn.UTCTime" title="pyderasn.UTCTime"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.UTCTime</span></code></a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">GeneralizedTime</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2017</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">123</span><span class="p">))</span>
<span class="go">GeneralizedTime GeneralizedTime 2017-09-30T22:07:50.000123</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="go">&#39;20170930220750.000123Z&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">GeneralizedTime</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2057</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">50</span><span class="p">))</span>
<span class="go">GeneralizedTime GeneralizedTime 2057-09-30T22:07:50</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Only <strong>naive</strong> datetime objects are supported.
Library assumes that all work is done in UTC.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Only <strong>microsecond</strong> fractions are supported in DER encoding.
<a class="reference internal" href="#pyderasn.DecodeError" title="pyderasn.DecodeError"><code class="xref py py-exc docutils literal"><span class="pre">pyderasn.DecodeError</span></code></a> will be raised during decoding of
higher precision values.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><strong>BER</strong> encoded data can loss information (accuracy) during
decoding because of float transformations.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><strong>Zero</strong> year is unsupported.</p>
</div>
<dl class="method">
<dt id="pyderasn.GeneralizedTime.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em>, <em>bounds=None</em>, <em>ctx=None</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.GeneralizedTime.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either datetime type, or
<a class="reference internal" href="#pyderasn.UTCTime" title="pyderasn.UTCTime"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.UTCTime</span></code></a> object</li>
<li><strong>impl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">IMPLICIT</span></code> one</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>default</strong> – set default value. Type same as in <code class="docutils literal"><span class="pre">value</span></code></li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="special-types">
<h2><a class="toc-backref" href="#toc-entry-40">Special types</a><a class="headerlink" href="#special-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="choice">
<h3><a class="toc-backref" href="#toc-entry-41">Choice</a><a class="headerlink" href="#choice" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.Choice">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Choice</code><span class="sig-paren">(</span><em>value=None</em>, <em>schema=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Choice" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">CHOICE</span></code> special type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">GeneralName</span><span class="p">(</span><span class="n">Choice</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;rfc822Name&quot;</span><span class="p">,</span> <span class="n">IA5String</span><span class="p">(</span><span class="n">impl</span><span class="o">=</span><span class="n">tag_ctxp</span><span class="p">(</span><span class="mi">1</span><span class="p">))),</span>
        <span class="p">(</span><span class="s2">&quot;dNSName&quot;</span><span class="p">,</span> <span class="n">IA5String</span><span class="p">(</span><span class="n">impl</span><span class="o">=</span><span class="n">tag_ctxp</span><span class="p">(</span><span class="mi">2</span><span class="p">))),</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gn</span> <span class="o">=</span> <span class="n">GeneralName</span><span class="p">()</span>
<span class="go">GeneralName CHOICE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn</span><span class="p">[</span><span class="s2">&quot;rfc822Name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">IA5String</span><span class="p">(</span><span class="s2">&quot;foo@bar.baz&quot;</span><span class="p">)</span>
<span class="go">GeneralName CHOICE rfc822Name[[1] IA5String IA5 foo@bar.baz]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn</span><span class="p">[</span><span class="s2">&quot;dNSName&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">IA5String</span><span class="p">(</span><span class="s2">&quot;bar.baz&quot;</span><span class="p">)</span>
<span class="go">GeneralName CHOICE dNSName[[2] IA5String IA5 bar.baz]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn</span><span class="p">[</span><span class="s2">&quot;rfc822Name&quot;</span><span class="p">]</span>
<span class="go">None</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn</span><span class="p">[</span><span class="s2">&quot;dNSName&quot;</span><span class="p">]</span>
<span class="go">[2] IA5String IA5 bar.baz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn</span><span class="o">.</span><span class="n">choice</span>
<span class="go">&#39;dNSName&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn</span><span class="o">.</span><span class="n">value</span> <span class="o">==</span> <span class="n">gn</span><span class="p">[</span><span class="s2">&quot;dNSName&quot;</span><span class="p">]</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gn</span><span class="o">.</span><span class="n">specs</span>
<span class="go">OrderedDict([(&#39;rfc822Name&#39;, [1] IA5String IA5), (&#39;dNSName&#39;, [2] IA5String IA5)])</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">GeneralName</span><span class="p">((</span><span class="s2">&quot;rfc822Name&quot;</span><span class="p">,</span> <span class="n">IA5String</span><span class="p">(</span><span class="s2">&quot;foo@bar.baz&quot;</span><span class="p">)))</span>
<span class="go">GeneralName CHOICE rfc822Name[[1] IA5String IA5 foo@bar.baz]</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyderasn.Choice.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>schema=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Choice.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either <code class="docutils literal"><span class="pre">(choice,</span> <span class="pre">value)</span></code> tuple, or
<a class="reference internal" href="#pyderasn.Choice" title="pyderasn.Choice"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Choice</span></code></a> object</li>
<li><strong>impl</strong> (<em>bytes</em>) – can not be set, do <strong>not</strong> use it</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>default</strong> – set default value. Type same as in <code class="docutils literal"><span class="pre">value</span></code></li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Choice.choice">
<code class="descname">choice</code><a class="headerlink" href="#pyderasn.Choice.choice" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the choice</p>
</dd></dl>

<dl class="attribute">
<dt id="pyderasn.Choice.value">
<code class="descname">value</code><a class="headerlink" href="#pyderasn.Choice.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Value of underlying choice</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="primitivetypes">
<h3><a class="toc-backref" href="#toc-entry-42">PrimitiveTypes</a><a class="headerlink" href="#primitivetypes" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.PrimitiveTypes">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">PrimitiveTypes</code><span class="sig-paren">(</span><em>value=None</em>, <em>schema=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.PrimitiveTypes" title="Permalink to this definition">¶</a></dt>
<dd><p>Predefined <code class="docutils literal"><span class="pre">CHOICE</span></code> for all generic primitive types</p>
<p>It could be useful for general decoding of some unspecified values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">PrimitiveTypes</span><span class="p">()</span><span class="o">.</span><span class="n">decod</span><span class="p">(</span><span class="n">hexdec</span><span class="p">(</span><span class="s2">&quot;0403666f6f&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">value</span>
<span class="go">OCTET STRING 3 bytes 666f6f</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PrimitiveTypes</span><span class="p">()</span><span class="o">.</span><span class="n">decod</span><span class="p">(</span><span class="n">hexdec</span><span class="p">(</span><span class="s2">&quot;0203123456&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">value</span>
<span class="go">INTEGER 1193046</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="any">
<h3><a class="toc-backref" href="#toc-entry-43">Any</a><a class="headerlink" href="#any" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.Any">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Any</code><span class="sig-paren">(</span><em>value=None</em>, <em>expl=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Any" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">ANY</span></code> special type</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Any</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="o">-</span><span class="mi">123</span><span class="p">))</span>
<span class="go">ANY INTEGER -123 (0X:7B)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Any</span><span class="p">(</span><span class="n">OctetString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;hello world&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
<span class="go">ANY 040b68656c6c6f20776f726c64</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hexenc</span><span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="go">b&#39;0x040x0bhello world&#39;</span>
</pre></div>
</div>
<dl class="method">
<dt id="pyderasn.Any.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>value=None</em>, <em>expl=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Any.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>value</strong> – set the value. Either any kind of pyderasn’s
<strong>ready</strong> object, or bytes. Pay attention that
<strong>no</strong> validation is performed if raw binary value
is valid TLV, except just tag decoding</li>
<li><strong>expl</strong> (<em>bytes</em>) – override default tag with <code class="docutils literal"><span class="pre">EXPLICIT</span></code> one</li>
<li><strong>optional</strong> (<em>bool</em>) – is object <code class="docutils literal"><span class="pre">OPTIONAL</span></code> in sequence</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="constructed-types">
<h2><a class="toc-backref" href="#toc-entry-44">Constructed types</a><a class="headerlink" href="#constructed-types" title="Permalink to this headline">¶</a></h2>
<div class="section" id="sequence">
<h3><a class="toc-backref" href="#toc-entry-45">Sequence</a><a class="headerlink" href="#sequence" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.Sequence">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Sequence</code><span class="sig-paren">(</span><em>value=None</em>, <em>schema=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Sequence" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">SEQUENCE</span></code> structure type</p>
<p>You have to make specification of sequence:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Extension</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;extnID&quot;</span><span class="p">,</span> <span class="n">ObjectIdentifier</span><span class="p">()),</span>
        <span class="p">(</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span> <span class="n">Boolean</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">)),</span>
        <span class="p">(</span><span class="s2">&quot;extnValue&quot;</span><span class="p">,</span> <span class="n">OctetString</span><span class="p">()),</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Then, you can work with it as with dictionary.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span> <span class="o">=</span> <span class="n">Extension</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Extension</span><span class="p">()</span><span class="o">.</span><span class="n">specs</span>
<span class="go">OrderedDict([</span>
<span class="go">    (&#39;extnID&#39;, OBJECT IDENTIFIER),</span>
<span class="go">    (&#39;critical&#39;, BOOLEAN False OPTIONAL DEFAULT),</span>
<span class="go">    (&#39;extnValue&#39;, OCTET STRING),</span>
<span class="go">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span><span class="p">[</span><span class="s2">&quot;extnID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;1.2.3&quot;</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">pyderasn.InvalidValueType</span>: <span class="n">invalid value type, expected: &lt;class &#39;pyderasn.ObjectIdentifier&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span><span class="p">[</span><span class="s2">&quot;extnID&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ObjectIdentifier</span><span class="p">(</span><span class="s2">&quot;1.2.3&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can determine if sequence is ready to be encoded:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span><span class="o">.</span><span class="n">ready</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">pyderasn.ObjNotReady</span>: <span class="n">object is not ready: extnValue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span><span class="p">[</span><span class="s2">&quot;extnValue&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">OctetString</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;foobar&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span><span class="o">.</span><span class="n">ready</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Value you want to assign, must have the same <strong>type</strong> as in
corresponding specification, but it can have different tags,
optional/default attributes – they will be taken from specification
automatically:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">TBSCertificate</span><span class="p">(</span><span class="n">Sequence</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="p">(</span>
        <span class="p">(</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="n">Version</span><span class="p">(</span><span class="n">expl</span><span class="o">=</span><span class="n">tag_ctxc</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;v1&quot;</span><span class="p">)),</span>
    <span class="p">[</span><span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tbs</span> <span class="o">=</span> <span class="n">TBSCertificate</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tbs</span><span class="p">[</span><span class="s2">&quot;version&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Version</span><span class="p">(</span><span class="s2">&quot;v2&quot;</span><span class="p">)</span> <span class="c1"># no need to explicitly add ``expl``</span>
</pre></div>
</div>
<p>Assign <code class="docutils literal"><span class="pre">None</span></code> to remove value from sequence.</p>
<p>You can set values in Sequence during its initialization:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">AlgorithmIdentifier</span><span class="p">((</span>
<span class="go">    (&quot;algorithm&quot;, ObjectIdentifier(&quot;1.2.3&quot;)),</span>
<span class="go">    (&quot;parameters&quot;, Any(Null()))</span>
<span class="go">))</span>
<span class="go">AlgorithmIdentifier SEQUENCE[algorithm: OBJECT IDENTIFIER 1.2.3; parameters: ANY 0500 OPTIONAL]</span>
</pre></div>
</div>
<p>You can determine if value exists/set in the sequence and take its value:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;extnID&quot;</span> <span class="ow">in</span> <span class="n">ext</span><span class="p">,</span> <span class="s2">&quot;extnValue&quot;</span> <span class="ow">in</span> <span class="n">ext</span><span class="p">,</span> <span class="s2">&quot;critical&quot;</span> <span class="ow">in</span> <span class="n">ext</span>
<span class="go">(True, True, False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span><span class="p">[</span><span class="s2">&quot;extnID&quot;</span><span class="p">]</span>
<span class="go">OBJECT IDENTIFIER 1.2.3</span>
</pre></div>
</div>
<p>But pay attention that if value has default, then it won’t be (not
in) in the sequence (because <code class="docutils literal"><span class="pre">DEFAULT</span></code> must not be encoded in
DER), but you can read its value:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;critical&quot;</span> <span class="ow">in</span> <span class="n">ext</span><span class="p">,</span> <span class="n">ext</span><span class="p">[</span><span class="s2">&quot;critical&quot;</span><span class="p">]</span>
<span class="go">(False, BOOLEAN False)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ext</span><span class="p">[</span><span class="s2">&quot;critical&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Boolean</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;critical&quot;</span> <span class="ow">in</span> <span class="n">ext</span><span class="p">,</span> <span class="n">ext</span><span class="p">[</span><span class="s2">&quot;critical&quot;</span><span class="p">]</span>
<span class="go">(True, BOOLEAN True)</span>
</pre></div>
</div>
<p>All defaulted values are always optional.</p>
<p id="allow-default-values-ctx">DER prohibits default value encoding and will raise an error if
default value is unexpectedly met during decode.
If <a class="reference internal" href="#bered-ctx"><span class="std std-ref">bered</span></a> context option is set, then no error
will be raised, but <code class="docutils literal"><span class="pre">bered</span></code> attribute set. You can disable strict
defaulted values existence validation by setting
<code class="docutils literal"><span class="pre">&quot;allow_default_values&quot;:</span> <span class="pre">True</span></code> <a class="reference internal" href="#ctx"><span class="std std-ref">context</span></a> option.</p>
<p>All values with DEFAULT specified are decoded atomically in
<a class="reference internal" href="#evgen-mode"><span class="std std-ref">evgen mode</span></a>. If DEFAULT value is some kind of
SEQUENCE, then it will be yielded as a single element, not
disassembled. That is required for DEFAULT existence check.</p>
<p>Two sequences are equal if they have equal specification (schema),
implicit/explicit tagging and the same values.</p>
</dd></dl>

</div>
<div class="section" id="set">
<h3><a class="toc-backref" href="#toc-entry-46">Set</a><a class="headerlink" href="#set" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.Set">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">Set</code><span class="sig-paren">(</span><em>value=None</em>, <em>schema=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.Set" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">SET</span></code> structure type</p>
<p>Its usage is identical to <a class="reference internal" href="#pyderasn.Sequence" title="pyderasn.Sequence"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.Sequence</span></code></a>.</p>
<p id="allow-unordered-set-ctx">DER prohibits unordered values encoding and will raise an error
during decode. If <a class="reference internal" href="#bered-ctx"><span class="std std-ref">bered</span></a> context option is set,
then no error will occur. Also you can disable strict values
ordering check by setting <code class="docutils literal"><span class="pre">&quot;allow_unordered_set&quot;:</span> <span class="pre">True</span></code>
<a class="reference internal" href="#ctx"><span class="std std-ref">context</span></a> option.</p>
</dd></dl>

</div>
<div class="section" id="sequenceof">
<h3><a class="toc-backref" href="#toc-entry-47">SequenceOf</a><a class="headerlink" href="#sequenceof" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.SequenceOf">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">SequenceOf</code><span class="sig-paren">(</span><em>value=None</em>, <em>schema=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.SequenceOf" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">SEQUENCE</span> <span class="pre">OF</span></code> sequence type</p>
<p>For that kind of type you must specify the object it will carry on
(bounds are for example here, not required):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Ints</span><span class="p">(</span><span class="n">SequenceOf</span><span class="p">):</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">()</span>
    <span class="n">bounds</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span> <span class="o">=</span> <span class="n">Ints</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">123</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">234</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span>
<span class="go">Ints SEQUENCE OF[INTEGER 123, INTEGER 234]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ints</span><span class="p">]</span>
<span class="go">[123, 234]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="mi">345</span><span class="p">))</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="gr">pyderasn.BoundsError</span>: <span class="n">unsatisfied bounds: 0 &lt;= 3 &lt;= 2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">INTEGER 234</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">345</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span>
<span class="go">Ints SEQUENCE OF[INTEGER 123, INTEGER 345]</span>
</pre></div>
</div>
<p>You can initialize sequence with preinitialized values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span> <span class="o">=</span> <span class="n">Ints</span><span class="p">([</span><span class="n">Integer</span><span class="p">(</span><span class="mi">123</span><span class="p">),</span> <span class="n">Integer</span><span class="p">(</span><span class="mi">234</span><span class="p">)])</span>
</pre></div>
</div>
<p>Also you can use iterator as a value:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ints</span> <span class="o">=</span> <span class="n">Ints</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">Integer</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)))</span>
</pre></div>
</div>
<p>And it won’t be iterated until encoding process. Pay attention that
bounds and required schema checks are done only during the encoding
process in that case! After encode was called, then value is zeroed
back to empty list and you have to set it again. That mode is useful
mainly with CER encoding mode, where all objects from the iterable
will be streamed to the buffer, without copying all of them to
memory first.</p>
</dd></dl>

</div>
<div class="section" id="setof">
<h3><a class="toc-backref" href="#toc-entry-48">SetOf</a><a class="headerlink" href="#setof" title="Permalink to this headline">¶</a></h3>
<dl class="class">
<dt id="pyderasn.SetOf">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">SetOf</code><span class="sig-paren">(</span><em>value=None</em>, <em>schema=None</em>, <em>bounds=None</em>, <em>impl=None</em>, <em>expl=None</em>, <em>default=None</em>, <em>optional=False</em>, <em>_decoded=(0</em>, <em>0</em>, <em>0)</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.SetOf" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal"><span class="pre">SET</span> <span class="pre">OF</span></code> sequence type</p>
<p>Its usage is identical to <a class="reference internal" href="#pyderasn.SequenceOf" title="pyderasn.SequenceOf"><code class="xref py py-class docutils literal"><span class="pre">pyderasn.SequenceOf</span></code></a>.</p>
</dd></dl>

</div>
</div>
<div class="section" id="various">
<h2><a class="toc-backref" href="#toc-entry-49">Various</a><a class="headerlink" href="#various" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="pyderasn.abs_decode_path">
<code class="descclassname">pyderasn.</code><code class="descname">abs_decode_path</code><span class="sig-paren">(</span><em>decode_path</em>, <em>rel_path</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.abs_decode_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an absolute decode path from current and relative ones</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>decode_path</strong> – current decode path, starting point. Tuple of strings</li>
<li><strong>rel_path</strong> – relative path to <code class="docutils literal"><span class="pre">decode_path</span></code>. Tuple of strings.
If first tuple’s element is “/”, then treat it as
an absolute path, ignoring <code class="docutils literal"><span class="pre">decode_path</span></code> as
starting point. Also this tuple can contain “..”
elements, stripping the leading element from
<code class="docutils literal"><span class="pre">decode_path</span></code></li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">abs_decode_path</span><span class="p">((</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;whatever&quot;</span><span class="p">))</span>
<span class="go">(&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;whatever&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abs_decode_path</span><span class="p">((</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;..&quot;</span><span class="p">,</span> <span class="s2">&quot;whatever&quot;</span><span class="p">))</span>
<span class="go">(&quot;foo&quot;, &quot;whatever&quot;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">abs_decode_path</span><span class="p">((</span><span class="s2">&quot;foo&quot;</span><span class="p">,</span> <span class="s2">&quot;bar&quot;</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">,</span> <span class="s2">&quot;baz&quot;</span><span class="p">,</span> <span class="s2">&quot;whatever&quot;</span><span class="p">))</span>
<span class="go">(&quot;baz&quot;, &quot;whatever&quot;)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyderasn.agg_octet_string">
<code class="descclassname">pyderasn.</code><code class="descname">agg_octet_string</code><span class="sig-paren">(</span><em>evgens</em>, <em>decode_path</em>, <em>raw</em>, <em>writer</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.agg_octet_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Aggregate constructed string (OctetString and its derivatives)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>evgens</strong> – iterator of generated events</li>
<li><strong>decode_path</strong> – points to the string we want to decode</li>
<li><strong>raw</strong> – slicebable (memoryview, bytearray, etc) with
the data evgens are generated on</li>
<li><strong>writer</strong> – buffer.write where string is going to be saved</li>
<li><strong>writer</strong> – where string is going to be saved. Must comply
with <code class="docutils literal"><span class="pre">io.RawIOBase.write</span></code> behaviour</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#agg-octet-string"><span class="std std-ref">agg_octet_string</span></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyderasn.ascii_visualize">
<code class="descclassname">pyderasn.</code><code class="descname">ascii_visualize</code><span class="sig-paren">(</span><em>ba</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.ascii_visualize" title="Permalink to this definition">¶</a></dt>
<dd><p>Output only ASCII printable characters, like in hexdump -C</p>
<p>Example output for given binary string (right part):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">92</span> <span class="mi">2</span><span class="n">b</span> <span class="mi">39</span> <span class="mi">20</span> <span class="mi">65</span> <span class="mi">91</span> <span class="n">e6</span> <span class="mi">8</span><span class="n">e</span>  <span class="mi">95</span> <span class="mi">93</span> <span class="mi">1</span><span class="n">a</span> <span class="mi">58</span> <span class="n">df</span> <span class="mi">02</span> <span class="mi">78</span> <span class="n">ea</span>  <span class="o">|.+</span><span class="mi">9</span> <span class="n">e</span><span class="o">......</span><span class="n">X</span><span class="o">..</span><span class="n">x</span><span class="o">.|</span>
                                                   <span class="o">^^^^^^^^^^^^^^^^</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyderasn.colonize_hex">
<code class="descclassname">pyderasn.</code><code class="descname">colonize_hex</code><span class="sig-paren">(</span><em>hexed</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.colonize_hex" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate hexadecimal string with colons</p>
</dd></dl>

<dl class="function">
<dt id="pyderasn.encode2pass">
<code class="descclassname">pyderasn.</code><code class="descname">encode2pass</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.encode2pass" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode (2-pass mode) to DER in memory buffer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns bytes:</th><td class="field-body">memory buffer contents</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyderasn.encode_cer">
<code class="descclassname">pyderasn.</code><code class="descname">encode_cer</code><span class="sig-paren">(</span><em>obj</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.encode_cer" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode to CER in memory buffer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns bytes:</th><td class="field-body">memory buffer contents</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyderasn.file_mmaped">
<code class="descclassname">pyderasn.</code><code class="descname">file_mmaped</code><span class="sig-paren">(</span><em>fd</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.file_mmaped" title="Permalink to this definition">¶</a></dt>
<dd><p>Make mmap-ed memoryview for reading from file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fd</strong> – file object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">memoryview over read-only mmap-ing of the whole file</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">It does not work under Windows.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="pyderasn.hexenc">
<code class="descclassname">pyderasn.</code><code class="descname">hexenc</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.hexenc" title="Permalink to this definition">¶</a></dt>
<dd><p>Hexadecimal string to binary data convert</p>
</dd></dl>

<dl class="function">
<dt id="pyderasn.hexdec">
<code class="descclassname">pyderasn.</code><code class="descname">hexdec</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.hexdec" title="Permalink to this definition">¶</a></dt>
<dd><p>Binary data to hexadecimal string convert</p>
</dd></dl>

<dl class="function">
<dt id="pyderasn.hexdump">
<code class="descclassname">pyderasn.</code><code class="descname">hexdump</code><span class="sig-paren">(</span><em>raw</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.hexdump" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate <code class="docutils literal"><span class="pre">hexdump</span> <span class="pre">-C</span></code> like output</p>
<p>Rendered example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>00000000  30 80 30 80 a0 80 02 01  02 00 00 02 14 54 a5 18  |0.0..........T..|
00000010  69 ef 8b 3f 15 fd ea ad  bd 47 e0 94 81 6b 06 6a  |i..?.....G...k.j|
</pre></div>
</div>
<p>Result of that function is a generator of lines, where each line is
a list of columns:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">[</span><span class="o">...</span><span class="p">],</span>
    <span class="p">[</span><span class="s2">&quot;00000010 &quot;</span><span class="p">,</span> <span class="s2">&quot; 69&quot;</span><span class="p">,</span> <span class="s2">&quot; ef&quot;</span><span class="p">,</span> <span class="s2">&quot; 8b&quot;</span><span class="p">,</span> <span class="s2">&quot; 3f&quot;</span><span class="p">,</span> <span class="s2">&quot; 15&quot;</span><span class="p">,</span> <span class="s2">&quot; fd&quot;</span><span class="p">,</span> <span class="s2">&quot; ea&quot;</span><span class="p">,</span> <span class="s2">&quot; ad &quot;</span><span class="p">,</span>
                  <span class="s2">&quot; bd&quot;</span><span class="p">,</span> <span class="s2">&quot; 47&quot;</span><span class="p">,</span> <span class="s2">&quot; e0&quot;</span><span class="p">,</span> <span class="s2">&quot; 94&quot;</span><span class="p">,</span> <span class="s2">&quot; 81&quot;</span><span class="p">,</span> <span class="s2">&quot; 6b&quot;</span><span class="p">,</span> <span class="s2">&quot; 06&quot;</span><span class="p">,</span> <span class="s2">&quot; 6a &quot;</span><span class="p">,</span>
                  <span class="s2">&quot; |i..?.....G...k.j|&quot;</span><span class="p">]</span>
    <span class="p">[</span><span class="o">...</span><span class="p">],</span>
<span class="p">]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="pyderasn.tag_encode">
<code class="descclassname">pyderasn.</code><code class="descname">tag_encode</code><span class="sig-paren">(</span><em>num</em>, <em>klass=0</em>, <em>form=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.tag_encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode tag to binary form</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>num</strong> (<em>int</em>) – tag’s number</li>
<li><strong>klass</strong> (<em>int</em>) – tag’s class (<code class="xref py py-data docutils literal"><span class="pre">pyderasn.TagClassUniversal</span></code>,
<code class="xref py py-data docutils literal"><span class="pre">pyderasn.TagClassContext</span></code>,
<code class="xref py py-data docutils literal"><span class="pre">pyderasn.TagClassApplication</span></code>,
<code class="xref py py-data docutils literal"><span class="pre">pyderasn.TagClassPrivate</span></code>)</li>
<li><strong>form</strong> (<em>int</em>) – tag’s form (<code class="xref py py-data docutils literal"><span class="pre">pyderasn.TagFormPrimitive</span></code>,
<code class="xref py py-data docutils literal"><span class="pre">pyderasn.TagFormConstructed</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pyderasn.tag_decode">
<code class="descclassname">pyderasn.</code><code class="descname">tag_decode</code><span class="sig-paren">(</span><em>tag</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.tag_decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode tag from binary form</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">No validation is performed, assuming that it has already passed.</p>
</div>
<p>It returns tuple with three integers, as
<a class="reference internal" href="#pyderasn.tag_encode" title="pyderasn.tag_encode"><code class="xref py py-func docutils literal"><span class="pre">pyderasn.tag_encode()</span></code></a> accepts.</p>
</dd></dl>

<dl class="function">
<dt id="pyderasn.tag_ctxp">
<code class="descclassname">pyderasn.</code><code class="descname">tag_ctxp</code><span class="sig-paren">(</span><em>num</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.tag_ctxp" title="Permalink to this definition">¶</a></dt>
<dd><p>Create CONTEXT PRIMITIVE tag</p>
</dd></dl>

<dl class="function">
<dt id="pyderasn.tag_ctxc">
<code class="descclassname">pyderasn.</code><code class="descname">tag_ctxc</code><span class="sig-paren">(</span><em>num</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.tag_ctxc" title="Permalink to this definition">¶</a></dt>
<dd><p>Create CONTEXT CONSTRUCTED tag</p>
</dd></dl>

<dl class="class">
<dt id="pyderasn.DecodeError">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">DecodeError</code><span class="sig-paren">(</span><em>msg=''</em>, <em>klass=None</em>, <em>decode_path=()</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.DecodeError" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="pyderasn.DecodeError.__init__">
<code class="descname">__init__</code><span class="sig-paren">(</span><em>msg=''</em>, <em>klass=None</em>, <em>decode_path=()</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.DecodeError.__init__" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>msg</strong> (<em>str</em>) – reason of decode failing</li>
<li><strong>klass</strong> – optional exact DecodeError inherited class (like
<a class="reference internal" href="#pyderasn.NotEnoughData" title="pyderasn.NotEnoughData"><code class="xref py py-exc docutils literal"><span class="pre">NotEnoughData</span></code></a>, <a class="reference internal" href="#pyderasn.TagMismatch" title="pyderasn.TagMismatch"><code class="xref py py-exc docutils literal"><span class="pre">TagMismatch</span></code></a>,
<a class="reference internal" href="#pyderasn.InvalidLength" title="pyderasn.InvalidLength"><code class="xref py py-exc docutils literal"><span class="pre">InvalidLength</span></code></a>)</li>
<li><strong>decode_path</strong> – tuple of strings. It contains human
readable names of the fields through which
decoding process has passed</li>
<li><strong>offset</strong> (<em>int</em>) – binary offset where failure happened</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pyderasn.NotEnoughData">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">NotEnoughData</code><span class="sig-paren">(</span><em>msg=''</em>, <em>klass=None</em>, <em>decode_path=()</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.NotEnoughData" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.ExceedingData">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">ExceedingData</code><span class="sig-paren">(</span><em>nbytes</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.ExceedingData" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.LenIndefForm">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">LenIndefForm</code><span class="sig-paren">(</span><em>msg=''</em>, <em>klass=None</em>, <em>decode_path=()</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.LenIndefForm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.TagMismatch">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">TagMismatch</code><span class="sig-paren">(</span><em>msg=''</em>, <em>klass=None</em>, <em>decode_path=()</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.TagMismatch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.InvalidLength">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">InvalidLength</code><span class="sig-paren">(</span><em>msg=''</em>, <em>klass=None</em>, <em>decode_path=()</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.InvalidLength" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.InvalidOID">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">InvalidOID</code><span class="sig-paren">(</span><em>msg=''</em>, <em>klass=None</em>, <em>decode_path=()</em>, <em>offset=0</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.InvalidOID" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.ObjUnknown">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">ObjUnknown</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.ObjUnknown" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.ObjNotReady">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">ObjNotReady</code><span class="sig-paren">(</span><em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.ObjNotReady" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.InvalidValueType">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">InvalidValueType</code><span class="sig-paren">(</span><em>expected_types</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.InvalidValueType" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="pyderasn.BoundsError">
<em class="property">class </em><code class="descclassname">pyderasn.</code><code class="descname">BoundsError</code><span class="sig-paren">(</span><em>bound_min</em>, <em>value</em>, <em>bound_max</em><span class="sig-paren">)</span><a class="headerlink" href="#pyderasn.BoundsError" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="command-line-usage">
<span id="cmdline"></span><h2><a class="toc-backref" href="#toc-entry-50">Command-line usage</a><a class="headerlink" href="#command-line-usage" title="Permalink to this headline">¶</a></h2>
<p>You can decode DER/BER files using command line abilities:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python -m pyderasn --schema tests.test_crts:Certificate path/to/file
</pre></div>
</div>
<p>If there is no schema for your file, then you can try parsing it without,
but of course IMPLICIT tags will often make it impossible. But result is
good enough for the certificate above:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python -m pyderasn path/to/file
    0   [1,3,1604]  . &gt;: SEQUENCE OF
    4   [1,3,1453]  . . &gt;: SEQUENCE OF
    8   [0,0,   5]  . . . . &gt;: [0] ANY
                    . . . . . A0:03:02:01:02
   13   [1,1,   3]  . . . . &gt;: INTEGER 61595
   18   [1,1,  13]  . . . . &gt;: SEQUENCE OF
   20   [1,1,   9]  . . . . . . &gt;: OBJECT IDENTIFIER 1.2.840.113549.1.1.5
   31   [1,1,   0]  . . . . . . &gt;: NULL
   33   [1,3, 274]  . . . . &gt;: SEQUENCE OF
   37   [1,1,  11]  . . . . . . &gt;: SET OF
   39   [1,1,   9]  . . . . . . . . &gt;: SEQUENCE OF
   41   [1,1,   3]  . . . . . . . . . . &gt;: OBJECT IDENTIFIER 2.5.4.6
   46   [1,1,   2]  . . . . . . . . . . &gt;: PrintableString PrintableString ES
[...]
 1409   [1,1,  50]  . . . . . . &gt;: SEQUENCE OF
 1411   [1,1,   8]  . . . . . . . . &gt;: OBJECT IDENTIFIER 1.3.6.1.5.5.7.1.1
 1421   [1,1,  38]  . . . . . . . . &gt;: OCTET STRING 38 bytes
                    . . . . . . . . . 30:24:30:22:06:08:2B:06:01:05:05:07:30:01:86:16
                    . . . . . . . . . 68:74:74:70:3A:2F:2F:6F:63:73:70:2E:69:70:73:63
                    . . . . . . . . . 61:2E:63:6F:6D:2F
 1461   [1,1,  13]  . . &gt;: SEQUENCE OF
 1463   [1,1,   9]  . . . . &gt;: OBJECT IDENTIFIER 1.2.840.113549.1.1.5
 1474   [1,1,   0]  . . . . &gt;: NULL
 1476   [1,2, 129]  . . &gt;: BIT STRING 1024 bits
                    . . . 68:EE:79:97:97:DD:3B:EF:16:6A:06:F2:14:9A:6E:CD
                    . . . 9E:12:F7:AA:83:10:BD:D1:7C:98:FA:C7:AE:D4:0E:2C
[...]
</pre></div>
</div>
<div class="section" id="human-readable-oids">
<h3><a class="toc-backref" href="#toc-entry-51">Human readable OIDs</a><a class="headerlink" href="#human-readable-oids" title="Permalink to this headline">¶</a></h3>
<p>If you have got dictionaries with ObjectIdentifiers, like example one
from <code class="docutils literal"><span class="pre">tests/test_crts.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">stroid2name</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;1.2.840.113549.1.1.1&quot;</span><span class="p">:</span> <span class="s2">&quot;id-rsaEncryption&quot;</span><span class="p">,</span>
    <span class="s2">&quot;1.2.840.113549.1.1.5&quot;</span><span class="p">:</span> <span class="s2">&quot;id-sha1WithRSAEncryption&quot;</span><span class="p">,</span>
    <span class="p">[</span><span class="o">...</span><span class="p">]</span>
    <span class="s2">&quot;2.5.4.10&quot;</span><span class="p">:</span> <span class="s2">&quot;id-at-organizationName&quot;</span><span class="p">,</span>
    <span class="s2">&quot;2.5.4.11&quot;</span><span class="p">:</span> <span class="s2">&quot;id-at-organizationalUnitName&quot;</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p>then you can pass it to pretty printer to see human readable OIDs:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python -m pyderasn --oids tests.test_crts:stroid2name path/to/file
[...]
   37   [1,1,  11]  . . . . . . &gt;: SET OF
   39   [1,1,   9]  . . . . . . . . &gt;: SEQUENCE OF
   41   [1,1,   3]  . . . . . . . . . . &gt;: OBJECT IDENTIFIER id-at-countryName (2.5.4.6)
   46   [1,1,   2]  . . . . . . . . . . &gt;: PrintableString PrintableString ES
   50   [1,1,  18]  . . . . . . &gt;: SET OF
   52   [1,1,  16]  . . . . . . . . &gt;: SEQUENCE OF
   54   [1,1,   3]  . . . . . . . . . . &gt;: OBJECT IDENTIFIER id-at-stateOrProvinceName (2.5.4.8)
   59   [1,1,   9]  . . . . . . . . . . &gt;: PrintableString PrintableString Barcelona
   70   [1,1,  18]  . . . . . . &gt;: SET OF
   72   [1,1,  16]  . . . . . . . . &gt;: SEQUENCE OF
   74   [1,1,   3]  . . . . . . . . . . &gt;: OBJECT IDENTIFIER id-at-localityName (2.5.4.7)
   79   [1,1,   9]  . . . . . . . . . . &gt;: PrintableString PrintableString Barcelona
[...]
</pre></div>
</div>
</div>
<div class="section" id="decode-paths">
<h3><a class="toc-backref" href="#toc-entry-52">Decode paths</a><a class="headerlink" href="#decode-paths" title="Permalink to this headline">¶</a></h3>
<p>Each decoded element has so-called decode path: sequence of structure
names it is passing during the decode process. Each element has its own
unique path inside the whole ASN.1 tree. You can print it out with
<code class="docutils literal"><span class="pre">--print-decode-path</span></code> option:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python -m pyderasn --schema path.to:Certificate --print-decode-path path/to/file
   0    [1,3,1604]  Certificate SEQUENCE []
   4    [1,3,1453]   . tbsCertificate: TBSCertificate SEQUENCE [tbsCertificate]
  10-2  [1,1,   1]   . . version: [0] EXPLICIT Version INTEGER v3 OPTIONAL [tbsCertificate:version]
  13    [1,1,   3]   . . serialNumber: CertificateSerialNumber INTEGER 61595 [tbsCertificate:serialNumber]
  18    [1,1,  13]   . . signature: AlgorithmIdentifier SEQUENCE [tbsCertificate:signature]
  20    [1,1,   9]   . . . algorithm: OBJECT IDENTIFIER 1.2.840.113549.1.1.5 [tbsCertificate:signature:algorithm]
  31    [0,0,   2]   . . . parameters: [UNIV 5] ANY OPTIONAL [tbsCertificate:signature:parameters]
                     . . . . 05:00
  33    [0,0, 278]   . . issuer: Name CHOICE rdnSequence [tbsCertificate:issuer]
  33    [1,3, 274]   . . . rdnSequence: RDNSequence SEQUENCE OF [tbsCertificate:issuer:rdnSequence]
  37    [1,1,  11]   . . . . 0: RelativeDistinguishedName SET OF [tbsCertificate:issuer:rdnSequence:0]
  39    [1,1,   9]   . . . . . 0: AttributeTypeAndValue SEQUENCE [tbsCertificate:issuer:rdnSequence:0:0]
  41    [1,1,   3]   . . . . . . type: AttributeType OBJECT IDENTIFIER 2.5.4.6 [tbsCertificate:issuer:rdnSequence:0:0:type]
  46    [0,0,   4]   . . . . . . value: [UNIV 19] AttributeValue ANY [tbsCertificate:issuer:rdnSequence:0:0:value]
                     . . . . . . . 13:02:45:53
  46    [1,1,   2]   . . . . . . . DEFINED BY 2.5.4.6: CountryName PrintableString ES [tbsCertificate:issuer:rdnSequence:0:0:value:DEFINED BY 2.5.4.6]
[...]
</pre></div>
</div>
<p>Now you can print only the specified tree, for example signature algorithm:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ python -m pyderasn --schema path.to:Certificate --decode-path-only tbsCertificate:signature path/to/file
  18    [1,1,  13]  AlgorithmIdentifier SEQUENCE
  20    [1,1,   9]   . algorithm: OBJECT IDENTIFIER 1.2.840.113549.1.1.5
  31    [0,0,   2]   . parameters: [UNIV 5] ANY OPTIONAL
                     . . 05:00
</pre></div>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Library reference</a><ul>
<li><a class="reference internal" href="#common-for-most-types">Common for most types</a><ul>
<li><a class="reference internal" href="#tags">Tags</a></li>
<li><a class="reference internal" href="#default-optional">Default/optional</a></li>
<li><a class="reference internal" href="#size-constraints">Size constraints</a></li>
<li><a class="reference internal" href="#common-methods">Common methods</a></li>
</ul>
</li>
<li><a class="reference internal" href="#decoding-1">Decoding</a><ul>
<li><a class="reference internal" href="#context">Context</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pretty-printing">Pretty printing</a></li>
<li><a class="reference internal" href="#defined-by">DEFINED BY</a><ul>
<li><a class="reference internal" href="#defines-kwarg">defines kwarg</a></li>
<li><a class="reference internal" href="#defines-by-path-context-option">defines_by_path context option</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ber-encoding">BER encoding</a></li>
<li><a class="reference internal" href="#allow-explicit-tag-out-of-bound">Allow explicit tag out-of-bound</a></li>
<li><a class="reference internal" href="#streaming-and-dealing-with-huge-structures">Streaming and dealing with huge structures</a><ul>
<li><a class="reference internal" href="#evgen-mode-1">evgen mode</a></li>
<li><a class="reference internal" href="#evgen-mode-upto">evgen_mode_upto</a></li>
<li><a class="reference internal" href="#mmap-ed-file">mmap-ed file</a></li>
<li><a class="reference internal" href="#cer-encoding">CER encoding</a></li>
<li><a class="reference internal" href="#agg-octet-string-1">agg_octet_string</a></li>
<li><a class="reference internal" href="#sequence-of-iterators">SEQUENCE OF iterators</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pass-der-encoding">2-pass DER encoding</a></li>
<li><a class="reference internal" href="#asn-1-browser">ASN.1 browser</a></li>
<li><a class="reference internal" href="#base-obj">Base Obj</a></li>
<li><a class="reference internal" href="#primitive-types">Primitive types</a><ul>
<li><a class="reference internal" href="#boolean">Boolean</a></li>
<li><a class="reference internal" href="#integer">Integer</a></li>
<li><a class="reference internal" href="#bitstring">BitString</a></li>
<li><a class="reference internal" href="#octetstring">OctetString</a></li>
<li><a class="reference internal" href="#null">Null</a></li>
<li><a class="reference internal" href="#objectidentifier">ObjectIdentifier</a></li>
<li><a class="reference internal" href="#enumerated">Enumerated</a></li>
<li><a class="reference internal" href="#commonstring">CommonString</a></li>
<li><a class="reference internal" href="#numericstring">NumericString</a></li>
<li><a class="reference internal" href="#printablestring">PrintableString</a></li>
<li><a class="reference internal" href="#ia5string">IA5String</a></li>
<li><a class="reference internal" href="#visiblestring">VisibleString</a></li>
<li><a class="reference internal" href="#utctime">UTCTime</a></li>
<li><a class="reference internal" href="#generalizedtime">GeneralizedTime</a></li>
</ul>
</li>
<li><a class="reference internal" href="#special-types">Special types</a><ul>
<li><a class="reference internal" href="#choice">Choice</a></li>
<li><a class="reference internal" href="#primitivetypes">PrimitiveTypes</a></li>
<li><a class="reference internal" href="#any">Any</a></li>
</ul>
</li>
<li><a class="reference internal" href="#constructed-types">Constructed types</a><ul>
<li><a class="reference internal" href="#sequence">Sequence</a></li>
<li><a class="reference internal" href="#set">Set</a></li>
<li><a class="reference internal" href="#sequenceof">SequenceOf</a></li>
<li><a class="reference internal" href="#setof">SetOf</a></li>
</ul>
</li>
<li><a class="reference internal" href="#various">Various</a></li>
<li><a class="reference internal" href="#command-line-usage">Command-line usage</a><ul>
<li><a class="reference internal" href="#human-readable-oids">Human readable OIDs</a></li>
<li><a class="reference internal" href="#decode-paths">Decode paths</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="examples.html"
                        title="previous chapter">Examples</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="news.html"
                        title="next chapter">News</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/reference.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="news.html" title="News"
             >next</a> |</li>
        <li class="right" >
          <a href="examples.html" title="Examples"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">pyderasn 9.3 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017-2022, Sergey Matveev.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.
    </div>
  </body>
</html>